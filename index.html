<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Личный интерактивный 8-месячный трекер обучения фронтенд разработке: цели, ресурсы, подзадачи, заметки, файлы и прогресс.">
  <meta property="og:title" content="Трекер обучения фронтенду (8 месяцев)">
  <meta property="og:description" content="Структурированный план на 196 дней с прогрессом, заметками и материалами.">
  <meta property="og:type" content="website">
  <meta property="og:locale" content="ru_RU">
  <title>План обучения фронтенду - 8 месяцев</title>
  <style>
    :root {
      --bg-primary: #1a1f2e;
      --bg-secondary: #242938;
      --bg-tertiary: #2d3447;
      --bg-card: #353b4e;
      --text-primary: #e8eaed;
      --text-secondary: #b8bcc4;
      --text-muted: #8b92a1;
      --border-color: rgba(99, 179, 237, 0.2);
      --gradient-primary: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
      --gradient-accent: linear-gradient(135deg, #06b6d4 0%, #3b82f6 100%);
      --shadow-color: rgba(0, 0, 0, 0.4);
      --glow: rgba(59, 130, 246, 0.3);
      --accent-color: #3b82f6;
      --radius-xs: 6px;
      --radius-s: 10px;
      --radius-m: 16px;
      --radius-l: 24px;
      --transition: .35s cubic-bezier(.4,0,.2,1);
      --focus-ring: 0 0 0 3px rgba(139,92,246,.5);
      --accent-gradient-faded: linear-gradient(135deg, rgba(59,130,246,.25), rgba(139,92,246,.25));
    }

    @media (prefers-color-scheme: light) {
      :root {
        --bg-primary: #f8f9fc;
        --bg-secondary: #ffffff;
        --bg-tertiary: #f1f3f9;
        --bg-card: #e8ebf3;
        --text-primary: #1e293b;
        --text-secondary: #475569;
        --text-muted: #64748b;
        --border-color: rgba(59, 130, 246, 0.15);
        --shadow-color: rgba(0, 0, 0, 0.06);
        --glow: rgba(59, 130, 246, 0.2);
        --accent-color: #3b82f6;
      }
    }

    body[data-theme="dark"] {
      --bg-primary: #1a1f2e;
      --bg-secondary: #242938;
      --bg-tertiary: #2d3447;
      --bg-card: #353b4e;
      --text-primary: #e8eaed;
      --text-secondary: #b8bcc4;
      --text-muted: #8b92a1;
      --border-color: rgba(99, 179, 237, 0.2);
      --shadow-color: rgba(0, 0, 0, 0.4);
      --glow: rgba(59, 130, 246, 0.3);
      --accent-color: #3b82f6;
    }

    body[data-theme="light"] {
      --bg-primary: #f8f9fc;
      --bg-secondary: #ffffff;
      --bg-tertiary: #f1f3f9;
      --bg-card: #e8ebf3;
      --text-primary: #1e293b;
      --text-secondary: #475569;
      --text-muted: #64748b;
      --border-color: rgba(59, 130, 246, 0.15);
      --shadow-color: rgba(0, 0, 0, 0.06);
      --glow: rgba(59, 130, 246, 0.2);
      --accent-color: #3b82f6;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--bg-primary);
      min-height: 100vh;
      padding: 20px;
      transition: background 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .container {
      max-width: 1440px;
      margin: 0 auto;
      background: var(--bg-secondary);
      border-radius: 32px;
      overflow: hidden;
      box-shadow: 0 40px 100px var(--shadow-color);
      border: 1px solid var(--border-color);
    }

    .header {
      background: var(--gradient-primary);
      color: white;
      padding: 60px 40px;
      text-align: center;
      position: relative;
    }

    .header h1 {
      font-size: 3em;
      margin-bottom: 16px;
      font-weight: 900;
      letter-spacing: -0.02em;
    }

    .header p {
      font-size: 1.2em;
      font-weight: 500;
    }

    .theme-toggle {
      position: absolute;
      top: 24px;
      right: 24px;
      background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      color: white;
      padding: 12px 18px;
      border-radius: 12px;
      cursor: pointer;
      font-size: 20px;
      z-index: 10;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .theme-toggle:hover {
      background: rgba(255, 255, 255, 0.25);
      transform: scale(1.05) rotate(15deg);
    }

    .stats {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 24px;
      padding: 32px;
      background: var(--bg-primary);
    }

    .stat {
      background: var(--bg-tertiary);
      padding: 32px;
      border-radius: 20px;
      text-align: center;
      border: 1px solid var(--border-color);
      transition: all 0.3s;
    }

    .stat:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 24px var(--glow);
    }

    .stat h3 {
      font-size: 12px;
      color: var(--text-muted);
      margin-bottom: 12px;
      text-transform: uppercase;
      letter-spacing: 2px;
      font-weight: 700;
    }

    .stat .num {
      font-size: 48px;
      font-weight: 900;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      position: relative;
    }
    /* Категорийная сводка */
    .categories-summary { display:grid; grid-template-columns: repeat(auto-fill,minmax(180px,1fr)); gap:16px; padding:0 32px 32px; }
    .cat-card { background: var(--bg-tertiary); border:1px solid var(--border-color); border-radius:16px; padding:14px 16px 18px; position:relative; overflow:hidden; display:flex; flex-direction:column; gap:8px; }
    .cat-card h4 { margin:0; font-size:13px; font-weight:700; letter-spacing:.5px; color: var(--text-secondary); text-transform:uppercase; }
    .cat-metric { font-size:20px; font-weight:800; color: var(--text-primary); }
    .cat-bar { height:6px; background: var(--bg-card); border-radius:4px; overflow:hidden; position:relative; }
    .cat-bar span { display:block; height:100%; width:0; background: var(--gradient-primary); transition: width .6s ease; }
    .cat-pct { font-size:11px; font-weight:600; color: var(--text-muted); letter-spacing:.5px; }
    .cat-card.highlight { box-shadow:0 0 0 1px #8b5cf6, 0 0 0 4px rgba(139,92,246,.25); }

    .progress-bar {
      height: 48px;
      background: var(--bg-tertiary);
      margin: 32px;
      border-radius: 24px;
      overflow: hidden;
      border: 1px solid var(--border-color);
      position: relative;
      box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .progress-fill {
      height: 100%;
      background: var(--gradient-primary);
      transition: width 0.6s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 700;
      font-size: 16px;
    }

    .controls {
      padding: 24px 32px;
      display: flex;
      gap: 16px;
      flex-wrap: wrap;
      background: var(--bg-primary);
      border-bottom: 1px solid var(--border-color);
    }

    input {
      flex: 1;
      min-width: 240px;
      padding: 14px 20px;
      border: 1px solid var(--border-color);
      border-radius: 12px;
      background: var(--bg-tertiary);
      color: var(--text-primary);
      font-size: 15px;
      transition: all 0.3s;
      font-weight: 500;
    }

    input:focus {
      outline: none;
      border-color: #8b5cf6;
      box-shadow: 0 0 0 4px var(--glow);
      transform: translateY(-2px);
    }

    input::placeholder {
      color: var(--text-muted);
    }

    button {
      padding: 14px 24px;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      font-weight: 700;
      font-size: 14px;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      letter-spacing: 0.5px;
    }
    button:focus-visible, input:focus-visible, textarea:focus-visible { outline: none; box-shadow: var(--focus-ring); }

    .btn-filter {
      background: var(--bg-card);
      color: var(--text-muted);
      border: 1px solid var(--border-color);
    }

    .btn-filter:hover {
      background: var(--bg-tertiary);
      transform: translateY(-3px);
      box-shadow: 0 8px 16px var(--shadow-color);
    }

    .btn-filter.active {
      background: var(--gradient-primary);
      color: white;
      border-color: transparent;
      box-shadow: 0 8px 24px var(--glow);
    }

    .btn-reset {
      background: var(--gradient-accent);
      color: white;
    }

    .btn-reset:hover {
      transform: translateY(-3px);
      box-shadow: 0 12px 24px rgba(245, 87, 108, 0.4);
    }

    .content {
      padding: 32px;
      background: var(--bg-primary);
    }

    .month {
      margin-bottom: 40px;
      border: 1px solid var(--border-color);
      border-radius: 24px;
      overflow: hidden;
      background: var(--bg-secondary);
      transition: all 0.3s;
    }

    .month:hover {
      box-shadow: 0 12px 40px var(--shadow-color);
    }

    .month-header {
      background: var(--gradient-primary);
      color: white;
      padding: 32px 36px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: all 0.3s;
    }

    .month-header-inner { display:flex; align-items:center; gap:22px; }
    .month-ring { --p:0; width:58px; height:58px; border-radius:50%; background: conic-gradient(#8b5cf6 calc(var(--p)*1%), rgba(255,255,255,.08) 0); position:relative; display:flex; align-items:center; justify-content:center; font-size:11px; font-weight:700; letter-spacing:.5px; }
    .month-ring::after { content:""; position:absolute; inset:6px; background:rgba(0,0,0,.25); border-radius:50%; backdrop-filter: blur(2px); }
    .month-ring span { position:relative; z-index:2; color:#fff; }

    .month-header:hover {
      filter: brightness(1.1);
    }

    .month-title {
      font-size: 1.8em;
      font-weight: 800;
      letter-spacing: -0.02em;
    }

    .week {
      border-bottom: 1px solid var(--border-color);
    }

    .week:last-child {
      border-bottom: none;
    }

    .week-header {
      background: var(--bg-tertiary);
      padding: 20px 28px;
      font-weight: 700;
      color: var(--text-primary);
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      transition: all 0.3s;
      border-left: 4px solid transparent;
    }

    .week-header:hover {
      background: var(--bg-card);
      border-left-color: #8b5cf6;
      padding-left: 32px;
    }
    .week-header:focus-visible { outline:none; box-shadow: var(--focus-ring); }
    .week-progress { margin:0 24px 18px 24px; height:10px; background: var(--bg-tertiary); border:1px solid var(--border-color); border-radius:14px; position:relative; overflow:hidden; }
    .week-progress span { position:absolute; left:0; top:0; bottom:0; width:0; background: var(--gradient-primary); display:block; transition: width .6s cubic-bezier(.4,0,.2,1); }
    .week-progress::after { content:attr(data-label); position:absolute; inset:0; display:flex; align-items:center; justify-content:center; font-size:10px; font-weight:600; color: var(--text-secondary); mix-blend-mode: difference; pointer-events:none; }

    .week-desc {
      background: var(--bg-secondary);
      padding: 18px 28px 6px 28px;
      font-size: 0.9em;
      line-height: 1.6;
      color: var(--text-secondary);
      border-left: 4px solid var(--accent-color);
      border-bottom: 1px solid var(--border-color);
    }

    .days {
      padding: 24px;
      background: var(--bg-secondary);
    }

    .day {
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      border-left: 4px solid var(--accent-color);
      border-radius: 16px;
      padding: 24px;
      margin-bottom: 20px;
      transition: all 0.3s;
    }

    .day:hover {
      transform: translateX(6px);
      box-shadow: 0 12px 24px var(--glow);
    }

    .day.done {
      background: rgba(34, 197, 94, 0.08);
      border-left-color: #22c55e;
    }

    .day-header {
      display: flex;
      gap: 18px;
      margin-bottom: 16px;
      align-items: flex-start;
    }

    .day-header input {
      width: 26px;
      height: 26px;
      cursor: pointer;
      margin-top: 2px;
      accent-color: #8b5cf6;
      border-radius: 6px;
    }

    .day-info {
      flex: 1;
    }

    .day-title {
      font-weight: 800;
      font-size: 1.15em;
      color: var(--text-primary);
      margin-bottom: 10px;
      letter-spacing: -0.01em;
    }

    .day-time {
      display: inline-block;
      background: var(--gradient-primary);
      color: white;
      padding: 6px 14px;
      border-radius: 8px;
      font-size: 13px;
      font-weight: 800;
      margin-left: 10px;
      letter-spacing: 0.5px;
    }

    .day-task {
      color: var(--text-secondary);
      line-height: 1.8;
      margin: 14px 0;
      font-size: 0.98em;
    }

    /* Цели и задачи (месяц/неделя/день) */
    .month-objectives, .week-objectives { background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 14px; padding: 14px 18px; margin: 12px 0 20px; }
    .month-objectives strong, .week-objectives strong { color: var(--text-primary); }
    .month-objectives .mo-goal, .week-objectives .wg-goal { color: var(--text-secondary); font-size: 0.9em; line-height: 1.5; margin-bottom: 8px; }
    .month-objectives ul, .week-objectives ul { list-style: disc; margin: 0 0 0 18px; padding: 0; color: var(--text-secondary); font-size: 0.85em; line-height: 1.4; }
    .day-goal-line { color: var(--text-secondary); font-size: 0.85em; margin-top: 4px; }
    .day-tasks-list { list-style: square; margin: 6px 0 4px 18px; padding: 0; color: var(--text-secondary); font-size: 0.8em; line-height: 1.4; }
    .day-tasks-list li { margin: 2px 0; }

    body[data-theme="dark"] .month-objectives ul,
    body[data-theme="dark"] .week-objectives ul,
    body[data-theme="dark"] .day-tasks-list,
    body[data-theme="dark"] .month-objectives .mo-goal,
    body[data-theme="dark"] .week-objectives .wg-goal,
    body[data-theme="dark"] .day-goal-line { color: var(--text-secondary); }

    .day-resources {
      margin-top: 18px;
      padding-top: 18px;
      border-top: 1px solid var(--border-color);
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
    }

    .day-resources a {
      display: inline-block;
      color: #a78bfa;
      text-decoration: none;
      font-size: 14px;
      font-weight: 700;
      padding: 8px 16px;
      background: rgba(139, 92, 246, 0.08);
      border-radius: 10px;
      border: 1px solid rgba(139, 92, 246, 0.2);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .day-resources a:hover {
      background: rgba(139, 92, 246, 0.15);
      border-color: rgba(139, 92, 246, 0.5);
      transform: translateY(-3px);
      box-shadow: 0 8px 16px var(--glow);
    }

    /* Дополнительные пользовательские элементы (заметки и вложения) */
    .day-extra {
      margin-top: 14px;
      padding-top: 14px;
      border-top: 1px dashed var(--border-color);
      display: flex;
      flex-direction: column;
      gap: 14px;
    }
    .note-block textarea {
      width: 100%;
      min-height: 90px;
      resize: vertical;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 10px;
      padding: 10px 14px;
      color: var(--text-primary);
      font-family: inherit;
      font-size: 14px;
      line-height: 1.5;
      transition: border .25s, background .25s;
    }
    .note-block textarea:focus { outline: none; border-color: #8b5cf6; box-shadow: 0 0 0 3px var(--glow); }
    .attachments-block {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .attach-links, .attach-files { display: flex; flex-wrap: wrap; gap: 8px; }
    .attach-links input[type="text"], .attach-links input[type="url"] {
      flex: 1 1 180px;
      min-width: 160px;
      padding: 8px 12px;
      border: 1px solid var(--border-color);
      background: var(--bg-secondary);
      border-radius: 8px;
      color: var(--text-primary);
      font-size: 13px;
    }
    .attach-links button, .user-links button, .user-files button {
      background: var(--gradient-primary);
      color: #fff;
      border: none;
      padding: 8px 14px;
      border-radius: 8px;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      transition: .3s;
    }
    .attach-links button:hover, .user-links button:hover, .user-files button:hover { filter: brightness(1.1); }
    .user-links, .user-files { list-style: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 6px; }
    .user-links li, .user-files li { display: flex; align-items: center; gap: 8px; background: var(--bg-secondary); padding: 6px 10px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 13px; }
    .user-links li button.x-btn, .user-files li button.x-btn { margin-left:auto; }
    .user-links a { color: #60a5fa; text-decoration: none; font-weight: 600; }
    .user-files a { color: #34d399; text-decoration: none; font-weight: 600; }
    /* Заметки (список) */
    #content .note-block ul li { background: var(--bg-secondary); border:1px solid var(--border-color); padding:6px 10px; border-radius:8px; font-size:12px; display:flex; align-items:center; gap:8px; }
    #content .note-block ul li .note-text { flex:1; color: var(--text-primary); }
  /* Кнопка удаления (уменьшена) */
  .del-btn { background: #ef4444 !important; font-size: 12px; width: 26px; height: 26px; display: inline-flex; align-items: center; justify-content: center; border-radius: 8px; box-shadow: 0 2px 6px rgba(239,68,68,.25); }
  .del-btn:hover { filter: brightness(1.15); transform: translateY(-2px); }
    .file-size { color: var(--text-muted); font-size: 11px; margin-left: auto; }
    .attach-hint { font-size: 11px; color: var(--text-muted); }
    .inline-badge { background: rgba(139,92,246,.15); color: #a78bfa; font-size: 10px; padding: 2px 6px; border-radius: 6px; font-weight: 600; letter-spacing: .5px; }
  /* Кнопка материалов — улучшенный стиль */
  .materials-toggle { margin-top: 10px; display: inline-flex; align-items: center; gap: 6px; cursor: pointer; font-size: 12px; font-weight: 600; background: linear-gradient(135deg, rgba(139,92,246,.35), rgba(167,139,250,.2)); color: #c4b5fd; padding: 6px 14px 6px 10px; border-radius: 18px; border: 1px solid rgba(167,139,250,.55); transition: background .35s, box-shadow .35s, border-color .35s; position: relative; }
  .materials-toggle:hover { background: linear-gradient(135deg, rgba(139,92,246,.5), rgba(167,139,250,.32)); box-shadow: 0 4px 14px var(--glow); }
  .materials-toggle.open { background: linear-gradient(135deg, rgba(139,92,246,.6), rgba(167,139,250,.45)); color: #fff; }
  .materials-toggle span.arrow { transition: transform .35s cubic-bezier(.4,0,.2,1); display: inline-block; font-size: 13px; }
  .materials-toggle.open span.arrow { transform: rotate(90deg); }
  .materials-toggle .mat-badges { display: inline-flex; gap: 4px; margin-left: 4px; }
  .mat-badge { background: rgba(0,0,0,.25); color: #fff; font-size: 10px; padding: 2px 6px; border-radius: 10px; line-height: 1; font-weight: 600; letter-spacing: .5px; display: inline-flex; align-items: center; gap: 2px; }
  .mat-badge.link { background: rgba(96,165,250,.35); color: #bfdbfe; }
  .mat-badge.file { background: rgba(52,211,153,.35); color: #d1fae5; }
  .mat-badge.note { background: rgba(251,191,36,.35); color: #fef3c7; }
  .materials-toggle.open .mat-badge { filter: brightness(1.15); }
  /* Анимация появления дополнительного блока */
  .day-extra { animation: none; }
  .day-extra.fade-in { animation: fadeSlide .35s ease; }
  @keyframes fadeSlide { from { opacity: 0; transform: translateY(-6px); } to { opacity: 1; transform: translateY(0); } }
  .day-extra.collapsed { display: none; }
  /* Внутренние раскрывающиеся секции (подзадачи, заметки, вложения) */
  .section-toggle { width:100%; text-align:left; background: var(--bg-card); color: var(--text-secondary); padding:8px 12px; border:1px solid var(--border-color); border-radius:8px; font-size:12px; font-weight:600; letter-spacing:.5px; display:flex; align-items:center; gap:6px; cursor:pointer; transition:.25s; }
  .section-toggle:hover { background: var(--bg-tertiary); }
  .section-toggle.open { background: var(--bg-card); color: var(--text-secondary); }
  .section-toggle .arrow { display:none; }
  .section-toggle.open .arrow { display:none; }
  .section-body { margin-top:8px; }
  .section-body.collapsed { display:none; }
  .st-progress { margin-left:auto; background:rgba(0,0,0,.25); padding:2px 6px; border-radius:6px; font-size:10px; font-weight:700; color:#fff; }
  .section-toggle.open .st-progress { background:rgba(255,255,255,.25); }
  /* Подзадачи внутри дня */
  .day-subtasks { margin: 4px 0 10px; padding: 10px 12px; background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 10px; }
  .day-subtasks h5 { margin: 0 0 8px; font-size: 12px; letter-spacing: .5px; font-weight: 700; color: var(--text-secondary); display:flex; align-items:center; gap:6px; }
  .subtask-list { list-style: none; margin: 0; padding: 0; display: flex; flex-direction: column; gap: 6px; }
  .subtask-item { display:flex; align-items:center; gap:8px; font-size:12px; }
  .subtask-item input[type="checkbox"] { cursor:pointer; accent-color:#8b5cf6; width:18px; height:18px; flex:0 0 auto; }
  .subtask-box { flex:1; display:flex; align-items:center; gap:8px; background:var(--bg-primary); border:1px solid var(--border-color); border-radius:8px; padding:6px 10px; min-height:34px; transition:border-color .25s; }
  .subtask-item.done .subtask-box { opacity:.65; text-decoration:line-through; }
  .subtask-box:hover { border-color:#8b5cf6; }
  .subtask-box button { background:none; border:none; color:var(--text-secondary); font-size:14px; padding:2px 6px; border-radius:4px; cursor:pointer; line-height:1; }
  .subtask-box button { background:none; border:none; color:var(--text-secondary); font-size:14px; padding:2px 6px; border-radius:4px; cursor:pointer; line-height:1; }
  .subtask-box button:hover { color:#ef4444; background:rgba(239,68,68,.08); }
  [data-theme="dark"] .subtask-box button { color:var(--text-muted); }
  [data-theme="dark"] .subtask-box button:hover { color:#f87171; }
  .subtask-box span { flex:1; }
  .subtask-box span { color: var(--text-primary); }
  .subtask-item.done .subtask-box span { color: var(--text-muted); }
  .subtask-box .sys-badge { font-size:9px; font-weight:600; letter-spacing:.5px; background:rgba(139,92,246,.25); color:#c4b5fd; padding:2px 5px; border-radius:6px; }
  .x-btn { background:none !important; border:none !important; color:var(--text-secondary); font-size:14px; padding:2px 6px; cursor:pointer; line-height:1; border-radius:4px; }
  .x-btn:hover { color:#ef4444; background:rgba(239,68,68,.08); }
  [data-theme="dark"] .x-btn { color:var(--text-muted); }
  [data-theme="dark"] .x-btn:hover { color:#f87171; }
  .add-subtask { display: flex; gap: 6px; margin-top: 8px; flex-wrap: wrap; }
  .add-subtask input { flex: 1 1 160px; min-width: 140px; padding: 6px 10px; border: 1px solid var(--border-color); border-radius: 8px; background: var(--bg-primary); color: var(--text-primary); font-size: 12px; }
  .add-subtask button { background: var(--gradient-primary); color: #fff; border: none; padding: 6px 14px; border-radius: 8px; font-size: 12px; font-weight: 600; cursor: pointer; }
  .add-subtask button:hover { filter: brightness(1.1); }
  .add-subtask button:focus-visible { outline:none; box-shadow: var(--focus-ring); }
  /* Стилизация file input */
  .file-wrapper { display: flex; align-items: center; gap: 12px; flex-wrap: wrap; }
  .file-wrapper input[type="file"] { display: none; }
  .file-btn { background: var(--gradient-accent); color: #fff; padding: 8px 16px; border-radius: 10px; font-size: 12px; font-weight: 600; cursor: pointer; display: inline-flex; align-items: center; gap: 6px; box-shadow: 0 4px 12px var(--shadow-color); transition: .3s; }
  .file-btn:hover { filter: brightness(1.1); transform: translateY(-2px); }
  .file-btn:active { transform: translateY(0); }
  .attach-links button { width: 42px; justify-content: center; padding: 8px 0; }
  .attach-hint { flex: 1 1 100%; }
    @media (max-width: 600px){
      .attach-links input[type="text"], .attach-links input[type="url"] { flex: 1 1 100%; }
      .attach-links { flex-direction: column; }
    }

    .collapsed {
      display: none;
    }

    /* Плавающая панель быстрых действий */
    .quick-panel { position: fixed; bottom: 24px; right: 24px; display: flex; flex-direction: column; gap: 10px; z-index: 200; }
    .qp-btn { background: var(--accent-gradient-faded); backdrop-filter: blur(8px); border:1px solid rgba(255,255,255,.15); color: var(--text-primary); font-size:12px; font-weight:600; padding:10px 16px; border-radius: 18px; cursor:pointer; display:flex; align-items:center; gap:6px; transition: var(--transition); }
    .qp-btn:hover { background: var(--gradient-primary); color:#fff; box-shadow:0 8px 24px var(--glow); }
    .qp-btn:focus-visible { outline:none; box-shadow: var(--focus-ring); }
    @media (max-width: 880px){ .quick-panel { right:12px; bottom:12px; } .qp-btn { padding:8px 12px; font-size:11px; } }
  .qp-small { font-size:10px; background: var(--bg-secondary); opacity:.85; }
  .storage-usage { background: var(--bg-tertiary); border:1px solid var(--border-color); padding:4px 8px; border-radius:10px; font-size:10px; font-weight:600; color: var(--text-secondary); display:flex; gap:6px; align-items:center; }
  .storage-usage-bar { flex:1; height:6px; background: var(--bg-card); border-radius:4px; overflow:hidden; position:relative; }
  .storage-usage-bar span { position:absolute; inset:0; width:0; background: linear-gradient(90deg, #06b6d4, #3b82f6, #8b5cf6); transition: width .6s ease; }
  /* Облачная синхронизация */
  .cloud-panel { padding: 12px 32px 0; display:flex; flex-wrap:wrap; gap:10px; align-items:center; }
  .cloud-badge { font-size:11px; font-weight:600; background: var(--bg-tertiary); padding:6px 10px; border:1px solid var(--border-color); border-radius:14px; display:flex; align-items:center; gap:6px; }
  .cloud-btn { background: var(--accent-gradient-faded); border:1px solid var(--border-color); color: var(--text-primary); font-size:11px; font-weight:600; padding:8px 12px; border-radius:10px; cursor:pointer; display:flex; align-items:center; gap:4px; transition: var(--transition); }
  .cloud-btn:hover { background: var(--gradient-primary); color:#fff; }
  .cloud-btn:disabled { opacity:.4; cursor:not-allowed; }
  .cloud-status-ok { color:#34d399; }
  .cloud-status-err { color:#f87171; }
  .cloud-status-warn { color:#fbbf24; }
  .cloud-last { font-size:10px; color: var(--text-muted); margin-left:auto; }
  .cloud-warn { flex:1 1 100%; background: rgba(239,68,68,.12); border:1px solid rgba(239,68,68,.4); color:#fca5a5; padding:6px 10px; border-radius:10px; font-size:11px; font-weight:600; }
  /* Google sign-in button compact */
  .cloud-btn-g { width:42px; padding:8px !important; display:flex; align-items:center; justify-content:center; }
  .cloud-btn-g .g-icon { width:20px; height:20px; display:block; }
  .cloud-btn-g svg { width:100%; height:100%; display:block; }

    /* Плавное раскрытие внутренних секций */
    .section-body { overflow: hidden; transition: max-height .45s ease; }
    .section-body.collapsed { max-height: 0 !important; padding-top:0 !important; }
    .section-body:not(.collapsed) { max-height: 800px; }

    @media (max-width: 768px) {
      .stats {
        grid-template-columns: 1fr 1fr;
      }

      .month-title {
        font-size: 1.4em;
      }

      .header h1 {
        font-size: 2em;
      }

      .header {
        padding: 40px 24px;
      }
    }
  </style>
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <button class="theme-toggle" onclick="toggleTheme()" title="Переключить тему">🌓</button>
      <h1>План обучения фронтенду на 8 месяцев</h1>
      <p>196 дней систематического изучения веб-разработки</p>
    </div>

    <div class="stats">
      <div class="stat">
        <h3>Всего дней</h3>
        <div class="num">196</div>
      </div>
      <div class="stat">
        <h3>Завершено</h3>
        <div class="num" id="done">0</div>
      </div>
      <div class="stat">
        <h3>Осталось</h3>
        <div class="num" id="left">196</div>
      </div>
      <div class="stat">
        <h3>Прогресс</h3>
        <div class="num" id="pct">0%</div>
      </div>
    </div>

    <div class="progress-bar">
      <div class="progress-fill" id="bar" style="width: 0%">0%</div>
    </div>

    <div class="controls">
      <input type="text" id="search" placeholder="Поиск по заданиям...">
      <button class="btn-filter active" onclick="filter('all')">Все</button>
      <button class="btn-filter" onclick="filter('done')">Завершено</button>
      <button class="btn-filter" onclick="filter('todo')">К изучению</button>
      <button class="btn-reset" onclick="reset()">Сбросить прогресс</button>
    </div>

    <div class="cloud-panel">
      <div class="cloud-badge" id="cloudStatus">☁️ Облако: оффлайн</div>
      <button class="cloud-btn cloud-btn-g" id="cloudGoogleBtn" type="button" onclick="cloudGoogleSignIn()" aria-label="Google вход" title="Google вход">
        <span class="g-icon" aria-hidden="true">
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path fill="#EA4335" d="M12 10.8v3.84h5.42c-.24 1.26-.98 2.33-2.08 3.05l3.36 2.61c1.96-1.81 3.09-4.47 3.09-7.66 0-.74-.07-1.45-.2-2.14H12z"/>
            <path fill="#34A853" d="M6.56 14.32 5.8 14.9l-2.68 2.06C5.08 20.6 8.29 22.5 12 22.5c2.7 0 4.96-.9 6.61-2.45l-3.36-2.61c-.9.6-2.05.96-3.25.96-2.51 0-4.65-1.69-5.44-3.97z"/>
            <path fill="#4A90E2" d="M5.8 9.1 3.12 7.04C2.41 8.37 2 9.9 2 11.5s.41 3.13 1.12 4.46l3.44-2.66c-.2-.6-.31-1.25-.31-1.9 0-.66.11-1.3.31-1.9z"/>
            <path fill="#FBBC05" d="M12 6.5c1.47 0 2.78.51 3.81 1.5l2.85-2.85C16.95 3.76 14.7 2.9 12 2.9 8.29 2.9 5.08 4.8 3.12 7.04L5.8 9.1c.79-2.28 2.93-3.97 5.44-3.97z"/>
          </svg>
        </span>
      </button>
      <button class="cloud-btn" id="cloudAnonBtn" type="button" onclick="cloudAnonSignIn()">👤 Аноним</button>
      <button class="cloud-btn" id="cloudUploadBtn" type="button" onclick="cloudUpload()" disabled>⬆ Сохранить</button>
      <button class="cloud-btn" id="cloudDownloadBtn" type="button" onclick="cloudDownload()" disabled>⬇ Загрузить</button>
      <button class="cloud-btn" id="cloudMergeBtn" type="button" onclick="cloudMerge()" disabled>🔀 Слить</button>
      <div class="cloud-last" id="cloudLastSync"></div>
    </div>

    <div style="padding:0 32px 8px; display:flex; flex-wrap:wrap; gap:12px; align-items:center;">
      <div class="storage-usage" id="storageUsage">
        <span>Хранилище</span>
        <div class="storage-usage-bar"><span id="storageUsageBar"></span></div>
        <strong id="storageUsagePct">0%</strong>
      </div>
      <div style="margin-left:auto; display:flex; gap:8px;">
        <button class="qp-btn qp-small" type="button" onclick="exportData()">⬇️ Экспорт</button>
        <button class="qp-btn qp-small" type="button" onclick="document.getElementById('importInput').click()">⬆️ Импорт</button>
        <input type="file" id="importInput" accept="application/json" style="display:none" onchange="handleImport(this)">
      </div>
    </div>

    <div class="categories-summary" id="categoriesSummary"></div>

    <div class="content" id="content"></div>
  </div>
  <div class="quick-panel" aria-label="Быстрые действия">
    <button class="qp-btn" type="button" onclick="scrollToNextIncomplete()">➡️ Следующий</button>
    <button class="qp-btn" type="button" onclick="expandAll()">🔓 Открыть все</button>
    <button class="qp-btn" type="button" onclick="collapseAll()">🔒 Свернуть все</button>
    <button class="qp-btn" type="button" onclick="resetFilter()">🎯 Сброс фильтра</button>
  </div>

  <script>
    /* === Firebase Cloud Sync (анонимная) === */
    // === Реальная конфигурация Firebase (заменена) ===
    const firebaseConfig = {
      apiKey: "AIzaSyCo560tNWLd4OqoTMc8g0DgxvsfFldMNWU",
      authDomain: "tracker-397f9.firebaseapp.com",
      projectId: "tracker-397f9",
      storageBucket: "tracker-397f9.appspot.com", // исправлено: используем *.appspot.com
      messagingSenderId: "578524159971",
      appId: "1:578524159971:web:7fbb385e5063ebac25cad6",
      measurementId: "G-2PD3FS0WCS" // не используется напрямую (analytics не подключаем)
    };
    // (Проверка плейсхолдеров удалена: конфигурация заполнена)
    let firebaseLoaded=false, auth=null, db=null, cloudUser=null, remoteSnapshotMeta=null;
    function loadFirebaseCompat(){
      if(firebaseLoaded) return Promise.resolve();
      const scripts=[
        'https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js',
        'https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js',
        'https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js'
      ];
      return scripts.reduce((p,src)=>p.then(()=>new Promise((res,rej)=>{const s=document.createElement('script'); s.src=src; s.onload=res; s.onerror=rej; document.head.appendChild(s);})),Promise.resolve())
        .then(()=>{ firebase.initializeApp(firebaseConfig); firebaseLoaded=true; initCloud(); })
        .catch(e=>console.warn('Firebase load error',e));
    }
    function initCloud(){
      try { auth=firebase.auth(); db=firebase.firestore(); auth.onAuthStateChanged(u=>{cloudUser=u; updateCloudUI(); if(u) fetchRemoteMeta();}); } catch(e){ console.warn('Cloud init error',e); }
    }
    // ==== Аутентификация (Google + аноним) ====
    function cloudAnonSignIn(){ loadFirebaseCompat().then(()=>{ if(!auth) return; if(cloudUser){ alert('Уже вошли'); return;} auth.signInAnonymously().catch(e=>alert('Ошибка входа: '+e.message)); }); }
    function cloudGoogleSignIn(){
      loadFirebaseCompat().then(()=>{
        if(!auth) return;
        const provider = new firebase.auth.GoogleAuthProvider();
        if(auth.currentUser && auth.currentUser.isAnonymous){
          auth.currentUser.linkWithPopup(provider)
            .then(()=>{ updateCloudUI(); initialCloudSync(); })
            .catch(err=>{
              if(err.code === 'auth/credential-already-in-use'){
                auth.signInWithPopup(provider).then(()=>{ cloudMerge(); }).catch(e=>alert('Ошибка входа: '+e.message));
              } else alert('Ошибка связывания: '+err.message);
            });
        } else {
          auth.signInWithPopup(provider)
            .then(()=>{ initialCloudSync(); })
            .catch(e=>{
              if(e?.code === 'auth/unauthorized-domain'){
                console.warn('[Firebase] Unauthorized domain. Требуется добавить текущий хост в Firebase → Authentication → Settings → Authorized domains.');
                alert('Домен не авторизован для OAuth.\n\nДобавь: "'+location.hostname+'" в Firebase Console → Authentication → Settings → Authorized domains.');
              } else {
                alert('Ошибка входа: '+e.message);
              }
            });
        }
      });
    }
    function cloudSignIn(){ cloudGoogleSignIn(); }
    function cloudSignOut(){ if(auth && cloudUser) auth.signOut(); }
    function snapshotLocal(){ return { version:2, exportedAt:new Date().toISOString(), state, notesState, attachmentsState, subtasksState, extraOpen, openState, sectionOpen, theme: document.body.getAttribute('data-theme') }; }
    function applySnapshot(obj){ if(!obj) return; if(obj.state) state=obj.state; if(obj.notesState) notesState=obj.notesState; if(obj.attachmentsState) attachmentsState=obj.attachmentsState; if(obj.subtasksState) subtasksState=obj.subtasksState; if(obj.extraOpen) extraOpen=obj.extraOpen; if(obj.openState) openState=obj.openState; if(obj.sectionOpen) sectionOpen=obj.sectionOpen; if(obj.theme){ document.body.setAttribute('data-theme', obj.theme); localStorage.setItem('theme', obj.theme);} save(); saveNotes(); saveAttachments(); saveSubtasks(); saveExtraOpen(); saveOpenState(); saveSectionOpen(); updateStats(); render(); }
    function docRef(){ if(!cloudUser) return null; return db.collection('users').doc(cloudUser.uid); }
  let cloudUploadQueued=null;
  function scheduleCloudUpload(){ if(!cloudUser || cloudUser.isAnonymous) return; if(cloudUploadQueued) clearTimeout(cloudUploadQueued); cloudUploadQueued = setTimeout(()=>cloudUpload(),1500); }
  function cloudUpload(){ if(!cloudUser){ return;} const ref=docRef(); if(!ref) return; const data=snapshotLocal(); ref.set({data, updatedAt: firebase.firestore.FieldValue.serverTimestamp()}).then(()=>{ localStorage.setItem('cloudLastSync', Date.now().toString()); remoteSnapshotMeta={updatedAt:new Date()}; updateCloudUI(); }).catch(e=>console.warn('Ошибка сохранения: '+e.message)); }
  function cloudDownload(){ if(!cloudUser){ alert('Сначала войдите'); return;} const ref=docRef(); if(!ref) return; ref.get().then(snap=>{ if(!snap.exists){ alert('В облаке нет данных'); return;} const payload=snap.data(); remoteSnapshotMeta={updatedAt: payload.updatedAt?.toDate?.()|| new Date()}; applySnapshot(payload.data); localStorage.setItem('cloudLastSync', Date.now().toString()); updateCloudUI(); }).catch(e=>alert('Ошибка загрузки: '+e.message)); }
  function cloudMerge(){ if(!cloudUser){ alert('Войдите'); return;} const ref=docRef(); if(!ref) return; ref.get().then(snap=>{ if(!snap.exists){ cloudUpload(); return;} const remote=snap.data()?.data||{}; const merged={...remote, ...snapshotLocal()}; applySnapshot(merged); cloudUpload(); }).catch(e=>alert('Ошибка merge: '+e.message)); }
  function initialCloudSync(){ const ref=docRef(); if(!ref) return; ref.get().then(snap=>{ if(snap.exists){ const payload=snap.data(); remoteSnapshotMeta={updatedAt: payload.updatedAt?.toDate?.()|| new Date()}; const remoteData=payload.data; const localTs=parseInt(localStorage.getItem('cloudLastSync')||'0'); const remoteTs=remoteSnapshotMeta.updatedAt.getTime(); if(remoteTs>localTs){ applySnapshot(remoteData); } else if(localTs && localTs>remoteTs){ cloudUpload(); } updateCloudUI(); } else { cloudUpload(); } }); }
    function fetchRemoteMeta(){ const ref=docRef(); if(!ref) return; ref.get().then(snap=>{ if(snap.exists){ const payload=snap.data(); remoteSnapshotMeta={updatedAt: payload.updatedAt?.toDate?.()|| new Date()}; updateCloudUI(); } }); }
    function fmtDate(d){ if(!d) return '-'; return d.toLocaleString(); }
  function updateCloudUI(){
    const st=document.getElementById('cloudStatus');
    const gBtn=document.getElementById('cloudGoogleBtn');
    const aBtn=document.getElementById('cloudAnonBtn');
    const up=document.getElementById('cloudUploadBtn');
    const dn=document.getElementById('cloudDownloadBtn');
    const mg=document.getElementById('cloudMergeBtn');
    const ls=document.getElementById('cloudLastSync');
    const lastSyncTs=localStorage.getItem('cloudLastSync');
    const lastSync= lastSyncTs? new Date(parseInt(lastSyncTs)):null;
    if(!st) return;
    const googleSVG = '<span class="g-icon" aria-hidden="true"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path fill="#EA4335" d="M12 10.8v3.84h5.42c-.24 1.26-.98 2.33-2.08 3.05l3.36 2.61c1.96-1.81 3.09-4.47 3.09-7.66 0-.74-.07-1.45-.2-2.14H12z"/><path fill="#34A853" d="M6.56 14.32 5.8 14.9l-2.68 2.06C5.08 20.6 8.29 22.5 12 22.5c2.7 0 4.96-.9 6.61-2.45l-3.36-2.61c-.9.6-2.05.96-3.25.96-2.51 0-4.65-1.69-5.44-3.97z"/><path fill="#4A90E2" d="M5.8 9.1 3.12 7.04C2.41 8.37 2 9.9 2 11.5s.41 3.13 1.12 4.46l3.44-2.66c-.2-.6-.31-1.25-.31-1.9 0-.66.11-1.3.31-1.9z"/><path fill="#FBBC05" d="M12 6.5c1.47 0 2.78.51 3.81 1.5l2.85-2.85C16.95 3.76 14.7 2.9 12 2.9 8.29 2.9 5.08 4.8 3.12 7.04L5.8 9.1c.79-2.28 2.93-3.97 5.44-3.97z"/></svg></span>';
    if(!cloudUser){
      st.textContent='☁️ Облако: оффлайн';
      st.className='cloud-badge cloud-status-err';
      if(gBtn){ gBtn.disabled=false; gBtn.innerHTML=googleSVG; gBtn.onclick=cloudGoogleSignIn; gBtn.setAttribute('aria-label','Google вход'); gBtn.title='Google вход'; }
      if(aBtn){ aBtn.disabled=false; aBtn.textContent='👤 Аноним'; aBtn.onclick=cloudAnonSignIn; }
      [up,dn,mg].forEach(b=>b && (b.disabled=true)); if(ls) ls.textContent='';
    } else {
      const anon=cloudUser.isAnonymous;
      st.textContent= anon? '☁️ Облако: аноним' : '☁️ Облако: Google';
      st.className='cloud-badge ' + (anon? 'cloud-status-warn':'cloud-status-ok');
      if(gBtn){
        if(anon){
          gBtn.innerHTML=googleSVG; gBtn.onclick=cloudGoogleSignIn; gBtn.setAttribute('aria-label','Связать с Google'); gBtn.title='Связать с Google';
        } else {
          gBtn.textContent='🚪'; gBtn.onclick=cloudSignOut; gBtn.setAttribute('aria-label','Выйти из Google'); gBtn.title='Выйти из Google';
        }
        gBtn.disabled=false;
      }
      if(aBtn){ aBtn.disabled=true; }
      [up,dn,mg].forEach(b=>b && (b.disabled=false));
      let metaTxt='';
      if(remoteSnapshotMeta?.updatedAt){ metaTxt+='Облако: '+fmtDate(remoteSnapshotMeta.updatedAt); }
      if(lastSync){ metaTxt+=(metaTxt?', ':'')+'Локал. sync: '+fmtDate(lastSync); }
      if(ls) ls.textContent=metaTxt;
    }
  }
    // ==== Конец блока Firebase ====
    // Инициализация состояния из localStorage или пустой объект
    let state = {};
    if (localStorage.getItem('frontendPlan')) {
      try {
        state = JSON.parse(localStorage.getItem('frontendPlan')) || {};
      } catch (e) {
        state = {};
      }
    }

    const plan = [
      // Месяц 1
      {
        month: 1, title: "Месяц 1. Основы веб-разработки", weeks: [
          {
            week: 1, title: "Неделя 1 — Интернет, HTTP, DNS", days: [
              { day: 1, title: "Как работает интернет", time: "2 ч", task: "Принципы работы сети, клиент ↔ сервер, создайте конспект.", links: ["MDN — Internet||https://developer.mozilla.org/ru/docs/Learn/Common_questions/Web_mechanics/How_does_the_Internet_work"] },
              { day: 2, title: "HTTP основы", time: "2 ч", task: "Методы, коды статуса, заголовки. Разбор вкладки Network.", links: ["MDN — HTTP overview||https://developer.mozilla.org/ru/docs/Web/HTTP/Overview"] },
              { day: 3, title: "DNS и домены", time: "2 ч", task: "Что такое DNS, доменное имя, поиск IP через nslookup/dig.", links: ["MDN — DNS||https://developer.mozilla.org/ru/docs/Glossary/DNS"] },
              { day: 4, title: "Хостинг и публикация", time: "2 ч", task: "Публикация HTML страницы на GitHub Pages.", links: ["GitHub Pages||https://pages.github.com/"] },
              { day: 5, title: "Как работает браузер", time: "2 ч", task: "Разбор рендера: парсинг, DOM, CSSOM, DevTools панели.", links: ["How browsers work||https://web.dev/articles/howbrowserswork"] },
              { day: 6, title: "Проект: Личная страница", time: "4-5 ч", task: "Статическая страница обо мне + публикация.", links: ["MDN HTML||https://developer.mozilla.org/ru/docs/Learn/HTML"] },
              { day: 7, title: "Git и терминал", time: "4-5 ч", task: "git init/add/commit/push, структура репозитория.", links: ["Git Guide||https://rogerdudler.github.io/git-guide/index.ru.html"] }
            ]
          },
          {
            week: 2, title: "Неделя 2 — Базовый HTML/CSS", days: [
              { day: 8, title: "Семантика HTML", time: "2 ч", task: "Заголовки, списки, ссылки, структура.", links: ["MDN Structuring HTML||https://developer.mozilla.org/ru/docs/Learn/HTML"] },
              { day: 9, title: "Формы", time: "2 ч", task: "input/select/textarea/label, базовая валидация атрибутами.", links: ["MDN Forms||https://developer.mozilla.org/ru/docs/Learn/Forms"] },
              { day: 10, title: "Основы CSS", time: "2 ч", task: "Селекторы, каскад, наследование, специфика.", links: ["What is CSS||https://developer.mozilla.org/ru/docs/Learn/CSS"] },
              { day: 11, title: "Box Model и Flex", time: "2 ч", task: "display, box-sizing, flex-контейнер.", links: ["Flexbox Guide||https://css-tricks.com/snippets/css/a-guide-to-flexbox/"] },
              { day: 12, title: "Адаптивность", time: "2 ч", task: "@media, относительные единицы, mobile-first.", links: ["Responsive MDN||https://developer.mozilla.org/ru/docs/Learn/CSS/CSS_layout/Responsive_Design"] },
              { day: 13, title: "Проект: Резюме", time: "4-5 ч", task: "Одностраничное CV c адаптивностью.", links: [] },
              { day: 14, title: "Шлифовка резюме", time: "4-5 ч", task: "Якоря, плавный скролл, улучшение типографики.", links: [] }
            ]
          },
          {
            week: 3, title: "Неделя 3 — Продвинутый CSS", days: [
              { day: 15, title: "Flexbox углубление", time: "2 ч", task: "Выравнивание, вложенные flex-структуры.", links: [] },
              { day: 16, title: "CSS Grid", time: "2 ч", task: "grid-template, fr, auto-fit.", links: ["Grid Guide||https://css-tricks.com/snippets/css/complete-guide-grid/"] },
              { day: 17, title: "Псевдоклассы/элементы", time: "2 ч", task: ":hover/:focus/::before/::after эффекты.", links: [] },
              { day: 18, title: "Sass/SCSS", time: "2 ч", task: "Переменные, вложенность, partials.", links: ["Sass Guide||https://sass-lang.com/guide"] },
              { day: 19, title: "Валидация форм", time: "2 ч", task: ":invalid, required, стили ошибок.", links: [] },
              { day: 20, title: "Проект: Лендинг", time: "4-5 ч", task: "Лендинг с формой и сетками.", links: [] },
              { day: 21, title: "Оптимизация CSS", time: "4-5 ч", task: "Структура SCSS, переменные, рефакторинг.", links: [] }
            ]
          },
          {
            week: 4, title: "Неделя 4 — Git, инструменты, среда", days: [
              { day: 22, title: "Git ветки", time: "2 ч", task: "branch/merge, fast-forward.", links: [] },
              { day: 23, title: "Pull Requests", time: "2 ч", task: "Fork/PR/review в GitHub.", links: [] },
              { day: 24, title: "CLI основы", time: "2 ч", task: "Навигация, создание файлов, права.", links: [] },
              { day: 25, title: "Node & npm", time: "2 ч", task: "package.json, scripts, semver.", links: ["Node.js||https://nodejs.org/ru/"] },
              { day: 26, title: "npm проект", time: "2 ч", task: "devDeps vs deps, обновления.", links: [] },
              { day: 27, title: "VS Code + ESLint + Prettier", time: "4-5 ч", task: "Настройка форматирования и линтинга.", links: ["Prettier||https://prettier.io/"] },
              { day: 28, title: "Проект: Workflow", time: "4-5 ч", task: "Рабочий процесс с ветками и PR.", links: [] }
            ]
          }
        ]
      },
      // Месяц 2
      {
        month: 2, title: "Месяц 2. Основы JavaScript", weeks: [
          {
            week: 5, title: "Неделя 5 — Введение в JS", days: [
              { day: 29, title: "Что такое JavaScript", time: "2 ч", task: "Роль JS в браузере, первые выражения.", links: ["MDN JS First Steps||https://developer.mozilla.org/ru/docs/Learn/JavaScript/First_steps"] },
              { day: 30, title: "Переменные и типы", time: "2 ч", task: "let/const, примитивы, typeof.", links: [] },
              { day: 31, title: "Условия и циклы", time: "2 ч", task: "if/switch/for/while игра 'Угадай число'.", links: [] },
              { day: 32, title: "Функции", time: "2 ч", task: "Параметры, возврат, стрелочные функции.", links: [] },
              { day: 33, title: "Строки и массивы", time: "2 ч", task: "Методы map/filter, практика.", links: [] },
              { day: 34, title: "Проект: To-Do (ч1)", time: "4-5 ч", task: "Добавление/удаление задач, массив в памяти.", links: [] },
              { day: 35, title: "Рефакторинг To-Do", time: "4-5 ч", task: "Модули (логика в функциях), хранение в localStorage.", links: [] }
            ]
          },
          {
            week: 6, title: "Неделя 6 — Объекты и DOM", days: [
              { day: 36, title: "Объекты/JSON", time: "2 ч", task: "Создание, доступ, сериализация JSON.", links: [] },
              { day: 37, title: "Массивы объектов", time: "2 ч", task: "filter/find/sort практические примеры.", links: [] },
              { day: 38, title: "DOM Введение", time: "2 ч", task: "querySelector/createElement.", links: [] },
              { day: 39, title: "События", time: "2 ч", task: "addEventListener, предотвращение перезагрузки.", links: [] },
              { day: 40, title: "Манипуляция классами", time: "2 ч", task: "classList.toggle для теминга.", links: [] },
              { day: 41, title: "Расширение To-Do", time: "4-5 ч", task: "Фильтр: все/активные/выполненные.", links: [] },
              { day: 42, title: "Отладка", time: "4-5 ч", task: "Breakpoint, Sources, stack trace.", links: [] }
            ]
          },
          {
            week: 7, title: "Неделя 7 — Асинхронность", days: [
              { day: 43, title: "Таймеры", time: "2 ч", task: "setTimeout/setInterval счетчик.", links: [] },
              { day: 44, title: "Promises", time: "2 ч", task: "Создание/цепочки then/catch.", links: [] },
              { day: 45, title: "Fetch API", time: "2 ч", task: "GET запрос к публичному API.", links: ["JSONPlaceholder||https://jsonplaceholder.typicode.com/"] },
              { day: 46, title: "async/await", time: "2 ч", task: "Переписать код на async/await.", links: [] },
              { day: 47, title: "Обработка ошибок", time: "2 ч", task: "try/catch/finally, пользовательские ошибки.", links: [] },
              { day: 48, title: "Проект: Мини SPA", time: "4-5 ч", task: "Список пользователей + детали + поиск.", links: [] },
              { day: 49, title: "Улучшение SPA", time: "4-5 ч", task: "Лоадер, сортировка, обработка ошибок.", links: [] }
            ]
          },
          {
            week: 8, title: "Неделя 8 — Node.js и сборка", days: [
              { day: 50, title: "Node.js основы", time: "2 ч", task: "Запуск скрипта, process.env.", links: [] },
              { day: 51, title: "CommonJS модули", time: "2 ч", task: "module.exports / require.", links: [] },
              { day: 52, title: "npm пакеты", time: "2 ч", task: "Установка lodash, импорт и использование.", links: [] },
              { day: 53, title: "ES модули", time: "2 ч", task: "import/export и Babel.", links: [] },
              { day: 54, title: "Webpack & Babel", time: "2 ч", task: "entry/output/loader/plugin.", links: [] },
              { day: 55, title: "Проект: SPA + сборка", time: "4-5 ч", task: "Перенос SPA в структуру с билдом.", links: [] },
              { day: 56, title: "ESLint/Prettier", time: "4-5 ч", task: "Настройка правил, фиксы.", links: [] }
            ]
          }
        ]
      },
      // Месяц 3
      {
        month: 3, title: "Месяц 3. React и современный фронтенд", weeks: [
          {
            week: 9, title: "Неделя 9 — Основы React", days: [
              { day: 57, title: "Quick Start", time: "2 ч", task: "Создание проекта (Vite) + первый компонент.", links: ["React Quick Start||https://react.dev/learn"] },
              { day: 58, title: "JSX", time: "2 ч", task: "Разметка в JS, выражения в JSX.", links: [] },
              { day: 59, title: "useState", time: "2 ч", task: "Счетчик, несколько состояний.", links: [] },
              { day: 60, title: "Рендер списков", time: "2 ч", task: "key и производительность.", links: [] },
              { day: 61, title: "Условный рендер", time: "2 ч", task: "Тернарные операторы, &&.", links: [] },
              { day: 62, title: "Проект: To-Do React", time: "4-5 ч", task: "Перенос To-Do на компоненты.", links: [] },
              { day: 63, title: "Стилизация", time: "4-5 ч", task: "CSS Modules / styled-components.", links: [] }
            ]
          },
          {
            week: 10, title: "Неделя 10 — Данные и маршруты", days: [
              { day: 64, title: "useEffect", time: "2 ч", task: "Загрузка данных при монтировании.", links: [] },
              { day: 65, title: "React Router", time: "2 ч", task: "Маршруты и Link.", links: [] },
              { day: 66, title: "Формы", time: "2 ч", task: "Контролируемые компоненты.", links: [] },
              { day: 67, title: "Context API", time: "2 ч", task: "Глобальные данные без проп-дрилинга.", links: [] },
              { day: 68, title: "useReducer", time: "2 ч", task: "Рефактор состояния To-Do.", links: [] },
              { day: 69, title: "Проект: Заметки", time: "4-5 ч", task: "Приложение заметок с роутингом.", links: [] },
              { day: 70, title: "Оптимизация заметок", time: "4-5 ч", task: "Поиск/сортировка/локальное хранение.", links: [] }
            ]
          },
          {
            week: 11, title: "Неделя 11 — Продвинутый React", days: [
              { day: 71, title: "Кастомные хуки", time: "2 ч", task: "Вынос повторной логики.", links: [] },
              { day: 72, title: "Порталы", time: "2 ч", task: "Модальное окно вне DOM-иерархии.", links: [] },
              { day: 73, title: "Оптимизация", time: "2 ч", task: "useMemo/useCallback/React.memo.", links: [] },
              { day: 74, title: "Анимации", time: "2 ч", task: "Framer Motion базовые переходы.", links: [] },
              { day: 75, title: "Error Boundaries", time: "2 ч", task: "Компонент ловли ошибок.", links: [] },
              { day: 76, title: "Проект: Улучшение заметок", time: "4-5 ч", task: "Модалки + анимации + обработка ошибок.", links: [] },
              { day: 77, title: "Тесты компонентов", time: "4-5 ч", task: "React Testing Library первые тесты.", links: [] }
            ]
          },
          {
            week: 12, title: "Неделя 12 — CSS фреймворки", days: [
              { day: 78, title: "Bootstrap", time: "2 ч", task: "Сетка/карточки/кнопки.", links: ["Bootstrap||https://getbootstrap.com/"] },
              { day: 79, title: "Tailwind ввод", time: "2 ч", task: "Утилитарные классы и конфигурация.", links: ["Tailwind||https://tailwindcss.com/"] },
              { day: 80, title: "Адаптивность Tailwind", time: "2 ч", task: "breakpoints и состояния.", links: [] },
              { day: 81, title: "Кастомизация Tailwind", time: "2 ч", task: "Настройка theme.", links: [] },
              { day: 82, title: "Сравнение подходов", time: "2 ч", task: "Переписать секцию: Bootstrap vs Tailwind.", links: [] },
              { day: 83, title: "Проект: Магазин (ч1)", time: "4-5 ч", task: "Карточки товаров + сетка.", links: [] },
              { day: 84, title: "Магазин улучшения", time: "4-5 ч", task: "Фильтры, корзина UI.", links: [] }
            ]
          }
        ]
      },
      // Месяц 4
      {
        month: 4, title: "Месяц 4. TypeScript, GraphQL, Next.js, Auth", weeks: [
          {
            week: 13, title: "Неделя 13 — TypeScript", days: [
              { day: 85, title: "Введение TS", time: "2 ч", task: "tsc init, компиляция hello.ts.", links: ["TypeScript||https://www.typescriptlang.org/"] },
              { day: 86, title: "Базовые типы", time: "2 ч", task: "string/number/boolean/array/tuple.", links: [] },
              { day: 87, title: "Интерфейсы", time: "2 ч", task: "interface vs type, расширение.", links: [] },
              { day: 88, title: "Generics", time: "2 ч", task: "Generic функции и интерфейсы.", links: [] },
              { day: 89, title: "TS + React", time: "2 ч", task: "Типизация Props/State.", links: [] },
              { day: 90, title: "Рефакторинг проектов", time: "4-5 ч", task: "Перенос To-Do на TS (strict).", links: [] },
              { day: 91, title: "Продвинутые типы", time: "4-5 ч", task: "Union/Intersection/utility types.", links: [] }
            ]
          },
          {
            week: 14, title: "Неделя 14 — GraphQL", days: [
              { day: 92, title: "Что такое GraphQL", time: "2 ч", task: "Запросы vs REST.", links: ["GraphQL Intro||https://graphql.org/learn/"] },
              { day: 93, title: "Схема и типы", time: "2 ч", task: "type Query/Mutation.", links: [] },
              { day: 94, title: "Запросы/мутации", time: "2 ч", task: "playground, variables.", links: [] },
              { day: 95, title: "Эволюция API", time: "2 ч", task: "Добавление поля + @deprecated.", links: [] },
              { day: 96, title: "GraphQL в React", time: "2 ч", task: "Apollo Client setup.", links: [] },
              { day: 97, title: "Проект: API + клиент", time: "4-5 ч", task: "Список книг (CRUD).", links: [] },
              { day: 98, title: "Улучшения проекта", time: "4-5 ч", task: "Пагинация/загрузка/ошибки.", links: [] }
            ]
          },
          {
            week: 15, title: "Неделя 15 — Next.js", days: [
              { day: 99, title: "Введение Next.js", time: "2 ч", task: "Структура, pages.", links: ["Next.js||https://nextjs.org/docs"] },
              { day: 100, title: "Маршрутизация", time: "2 ч", task: "Навигация + layout.", links: [] },
              { day: 101, title: "SSR и SSG", time: "2 ч", task: "getServerSideProps/getStaticProps.", links: [] },
              { day: 102, title: "Динамические маршруты", time: "2 ч", task: "[id] и getStaticPaths.", links: [] },
              { day: 103, title: "Image и стили", time: "2 ч", task: "next/image + CSS Modules.", links: [] },
              { day: 104, title: "Проект: Блог (ч1)", time: "4-5 ч", task: "Markdown статьи + динамические страницы.", links: [] },
              { day: 105, title: "Блог улучшения", time: "4-5 ч", task: "SEO + деплой Vercel.", links: [] }
            ]
          },
          {
            week: 16, title: "Неделя 16 — Аутентификация и безопасность", days: [
              { day: 106, title: "Основы Auth", time: "2 ч", task: "JWT vs Cookies vs OAuth.", links: [] },
              { day: 107, title: "NextAuth", time: "2 ч", task: "Провайдер GitHub вход.", links: [] },
              { day: 108, title: "XSS/CSRF", time: "2 ч", task: "Примеры атак и защита.", links: [] },
              { day: 109, title: "Защита маршрутов", time: "2 ч", task: "Middleware auth.", links: [] },
              { day: 110, title: "UI библиотеки", time: "2 ч", task: "Material UI настройка темы.", links: [] },
              { day: 111, title: "CMS интеграция", time: "4-5 ч", task: "Headless CMS контент.", links: [] },
              { day: 112, title: "Аудит безопасности", time: "4-5 ч", task: "Проверка заголовков, CSP.", links: [] }
            ]
          }
        ]
      },
      // Месяц 5
      {
        month: 5, title: "Месяц 5. Тестирование и качество", weeks: [
          {
            week: 17, title: "Неделя 17 — Юнит-тесты", days: [
              { day: 113, title: "Jest ввод", time: "2 ч", task: "Установка + первый тест.", links: ["Jest||https://jestjs.io/"] },
              { day: 114, title: "Matchers", time: "2 ч", task: "toBe/toEqual/toContain.", links: [] },
              { day: 115, title: "Mocks & Timers", time: "2 ч", task: "jest.fn()/fake timers.", links: [] },
              { day: 116, title: "Snapshot", time: "2 ч", task: "Снапшот компонента.", links: [] },
              { day: 117, title: "RTL", time: "2 ч", task: "Render + screen.getBy*.", links: [] },
              { day: 118, title: "Проект: Тесты заметок", time: "4-5 ч", task: "CRUD тесты.", links: [] },
              { day: 119, title: "Coverage", time: "4-5 ч", task: "Отчет покрытия + улучшения.", links: [] }
            ]
          },
          {
            week: 18, title: "Неделя 18 — Cypress (E2E)", days: [
              { day: 120, title: "Cypress ввод", time: "2 ч", task: "init и первый spec.", links: [] },
              { day: 121, title: "Поиск элементов", time: "2 ч", task: "cy.get/contains.", links: [] },
              { day: 122, title: "Взаимодействия", time: "2 ч", task: "click/type/check.", links: [] },
              { day: 123, title: "Сеть и intercept", time: "2 ч", task: "Мокирование ответа.", links: [] },
              { day: 124, title: "Стратегии", time: "2 ч", task: "Организация тестов.", links: [] },
              { day: 125, title: "Проект: E2E блог", time: "4-5 ч", task: "Навигация + форма создания.", links: [] },
              { day: 126, title: "CI для Cypress", time: "4-5 ч", task: "GitHub Actions workflow.", links: [] }
            ]
          },
          {
            week: 19, title: "Неделя 19 — Производительность и a11y", days: [
              { day: 127, title: "Метрики", time: "2 ч", task: "FCP/LCP/CLS измерение Lighthouse.", links: [] },
              { day: 128, title: "Оптимизация загрузки", time: "2 ч", task: "Code splitting, lazy.", links: [] },
              { day: 129, title: "Accessibility основы", time: "2 ч", task: "ARIA, контраст.", links: [] },
              { day: 130, title: "Практика a11y", time: "2 ч", task: "Фокус, alt, aria-label.", links: [] },
              { day: 131, title: "PWA основы", time: "2 ч", task: "Service Worker, manifest.", links: [] },
              { day: 132, title: "Проект: PWA", time: "4-5 ч", task: "Добавить offline кеш статических ресурсов.", links: [] },
              { day: 133, title: "Оптимизация отчета", time: "4-5 ч", task: "Повторный прогон Lighthouse.", links: [] }
            ]
          },
          {
            week: 20, title: "Неделя 20 — Mobile/Desktop", days: [
              { day: 134, title: "React Native ввод", time: "2 ч", task: "Создание проекта Expo.", links: [] },
              { day: 135, title: "RN компоненты", time: "2 ч", task: "View/Text/Button/state.", links: [] },
              { day: 136, title: "RN навигация", time: "2 ч", task: "react-navigation stack.", links: [] },
              { day: 137, title: "Electron основы", time: "2 ч", task: "Первое окно, main/renderer.", links: [] },
              { day: 138, title: "API во фронте", time: "2 ч", task: "fetch/axios общие паттерны.", links: [] },
              { day: 139, title: "Проект: RN To-Do", time: "4-5 ч", task: "AsyncStorage список задач.", links: [] },
              { day: 140, title: "Проект: Electron заметки", time: "4-5 ч", task: "Файловое хранение заметок.", links: [] }
            ]
          }
        ]
      },
      // Месяц 6
      {
        month: 6, title: "Месяц 6. Визуализация, генераторы, CI/CD", weeks: [
          {
            week: 21, title: "Неделя 21 — Визуализация и анимации", days: [
              { day: 141, title: "Chart.js/D3 ввод", time: "2 ч", task: "Простой бар-чарт.", links: [] },
              { day: 142, title: "CSS анимации", time: "2 ч", task: "transition/animation keyframes.", links: [] },
              { day: 143, title: "Framer Motion", time: "2 ч", task: "AnimatePresence.", links: [] },
              { day: 144, title: "Интерактивная диаграмма", time: "2 ч", task: "Hover tooltip.", links: [] },
              { day: 145, title: "Чарт в React", time: "2 ч", task: "Компонент Chart пропсы.", links: [] },
              { day: 146, title: "Проект: Навыки визуализация", time: "4-5 ч", task: "Диаграмма навыков + анимация.", links: [] },
              { day: 147, title: "Доступность графики", time: "4-5 ч", task: "ARIA описание диаграмм.", links: [] }
            ]
          },
          {
            week: 22, title: "Неделя 22 — SSG и CMS", days: [
              { day: 148, title: "SSG концепция", time: "2 ч", task: "Gatsby/Astro обзор.", links: [] },
              { day: 149, title: "Gatsby старт", time: "2 ч", task: "Структура и запуск.", links: [] },
              { day: 150, title: "Страницы + GraphQL", time: "2 ч", task: "Markdown источники.", links: [] },
              { day: 151, title: "Плагины", time: "2 ч", task: "gatsby-plugin-image/SEO.", links: [] },
              { day: 152, title: "Headless CMS", time: "2 ч", task: "Подключение Strapi/Contentful.", links: [] },
              { day: 153, title: "Проект: Блог на Gatsby", time: "4-5 ч", task: "Сборка и оптимизация.", links: [] },
              { day: 154, title: "Деплой SSG", time: "4-5 ч", task: "Netlify/Vercel автодеплой.", links: [] }
            ]
          },
          {
            week: 23, title: "Неделя 23 — CI/CD и инфраструктура", days: [
              { day: 155, title: "CI/CD основы", time: "2 ч", task: "Пайплайн принципы.", links: [] },
              { day: 156, title: "GitHub Actions", time: "2 ч", task: "Workflow install+test+build.", links: [] },
              { day: 157, title: "Деплой шаг", time: "2 ч", task: "Автопубликация.", links: [] },
              { day: 158, title: "Docker ввод", time: "2 ч", task: "Dockerfile React/Node.", links: [] },
              { day: 159, title: "Docker Compose", time: "2 ч", task: "frontend+api локально.", links: [] },
              { day: 160, title: "Проект: Prod конфигурация", time: "4-5 ч", task: "CI+Docker+деплой.", links: [] },
              { day: 161, title: "Стресс тест", time: "4-5 ч", task: "autocannon/Lighthouse.", links: [] }
            ]
          },
          {
            week: 24, title: "Неделя 24 — Advanced & Real-time", days: [
              { day: 162, title: "Web Components", time: "2 ч", task: "Custom Elements + Shadow DOM.", links: [] },
              { day: 163, title: "i18n", time: "2 ч", task: "next-i18next настройка.", links: [] },
              { day: 164, title: "WebSockets", time: "2 ч", task: "Socket.io чат.", links: [] },
              { day: 165, title: "Микро-фронтенды", time: "2 ч", task: "Концепция и кейсы.", links: [] },
              { day: 166, title: "GraphQL Subscriptions", time: "2 ч", task: "Реал-тайм канал.", links: [] },
              { day: 167, title: "Проект: Real-time", time: "4-5 ч", task: "Чат/панель мониторинга.", links: [] },
              { day: 168, title: "Оптимизация real-time", time: "4-5 ч", task: "Производительность и деплой.", links: [] }
            ]
          }
        ]
      },
      // Месяц 7
      {
        month: 7, title: "Месяц 7. Повторение и итоговый проект (подготовка)", weeks: [
          {
            week: 25, title: "Неделя 25 — Повторение", days: [
              { day: 169, title: "Анализ прогресса", time: "2 ч", task: "Список тем для повторения.", links: [] },
              { day: 170, title: "HTML/CSS повтор", time: "2 ч", task: "Семантика + адаптивность.", links: [] },
              { day: 171, title: "JavaScript повтор", time: "2 ч", task: "Типы, функции, async.", links: [] },
              { day: 172, title: "React/Next повтор", time: "2 ч", task: "Компоненты/SSR.", links: [] },
              { day: 173, title: "Git/CI повтор", time: "2 ч", task: "Workflows.", links: [] },
              { day: 174, title: "План итогового проекта", time: "4-5 ч", task: "ТЗ, прототип.", links: [] },
              { day: 175, title: "Подготовка репозитория", time: "4-5 ч", task: "Структура, стек.", links: [] }
            ]
          },
          {
            week: 26, title: "Неделя 26 — Итоговый проект: разработка", days: [
              { day: 176, title: "Старт проекта", time: "2 ч", task: "Создание базовой структуры.", links: [] },
              { day: 177, title: "UI каркас", time: "2 ч", task: "Навигация/шапка.", links: [] },
              { day: 178, title: "Состояние", time: "2 ч", task: "Context/Redux.", links: [] },
              { day: 179, title: "Backend/API", time: "2 ч", task: "Подключение API или mock.", links: [] },
              { day: 180, title: "Ключевой функционал", time: "2 ч", task: "CRUD/поиск.", links: [] },
              { day: 181, title: "Auth & защита", time: "4-5 ч", task: "Авторизация и ошибки.", links: [] },
              { day: 182, title: "PWA функции", time: "4-5 ч", task: "Service Worker/offline.", links: [] }
            ]
          },
          {
            week: 27, title: "Неделя 27 — Тесты и оптимизация", days: [
              { day: 183, title: "Юнит-тесты", time: "2 ч", task: "Покрытие логики.", links: [] },
              { day: 184, title: "E2E тесты", time: "2 ч", task: "Основные сценарии.", links: [] },
              { day: 185, title: "Производительность", time: "2 ч", task: "Lighthouse улучшения.", links: [] },
              { day: 186, title: "Доступность", time: "2 ч", task: "axe DevTools.", links: [] },
              { day: 187, title: "SEO оптимизация", time: "2 ч", task: "Metadata/OpenGraph.", links: [] },
              { day: 188, title: "UI/UX polishing", time: "4-5 ч", task: "Правки интерфейса.", links: [] },
              { day: 189, title: "Release подготовка", time: "4-5 ч", task: "CI/CD финальный.", links: [] }
            ]
          }
        ]
      },
      // Месяц 8
      {
        month: 8, title: "Месяц 8. Презентация и финал", weeks: [
          {
            week: 28, title: "Неделя 28 — Завершение", days: [
              { day: 190, title: "README", time: "2 ч", task: "Описание проекта.", links: [] },
              { day: 191, title: "Презентация", time: "2 ч", task: "Слайды/демо.", links: [] },
              { day: 192, title: "Самоанализ", time: "2 ч", task: "Что улучшить дальше.", links: [] },
              { day: 193, title: "Обновление профилей", time: "2 ч", task: "GitHub/LinkedIn.", links: [] },
              { day: 194, title: "План развития", time: "2 ч", task: "Следующие технологии.", links: [] },
              { day: 195, title: "Open Source/Хакатоны", time: "4-5 ч", task: "Выбор репозитория.", links: [] },
              { day: 196, title: "Финиш!", time: "4-5 ч", task: "Подведение итогов и отдых.", links: [] }
            ]
          }
        ]
      }
    ];

    // --- Мета: цели месяцев (goal) ---
    const monthMeta = {
      1: { goal: 'Сформировать фундамент: понять устройство интернета, освоить базовый и продвинутый HTML/CSS и рабочие инструменты.' },
      2: { goal: 'Освоить основы JavaScript, работу с DOM, асинхронность и базовую сборку.' },
      3: { goal: 'Погрузиться в React и современные подходы к стилизации и архитектуре.' },
      4: { goal: 'Добавить типизацию (TypeScript), GraphQL, Next.js и понять основы безопасности.' },
      5: { goal: 'Внедрить культуру качества: тестирование (юнит/E2E), производительность и доступность.' },
      6: { goal: 'Научиться визуализации, статической генерации, CI/CD и продвинутым паттернам.' },
      7: { goal: 'Систематизировать знания и реализовать итоговый проект.' },
      8: { goal: 'Финализация, презентация результата и планирование дальнейшего развития.' }
    };

    // --- Генерация задач (списков) на лету ---
    function buildMonthTasks(month){
      return month.weeks.map(w => w.title.replace(/^[^—]*—\s*/,'').trim());
    }
    function buildWeekTasks(week){
      return week.days.map(d => `День ${d.day}: ${d.title}`);
    }
    function buildDayTasks(day){
      // Разбиваем описание на подзадачи по запятым/точкам/точкам с запятой
      const raw = (day.task||'').split(/[\.;,]/).map(s=>s.trim()).filter(s=>s.length>3);
      // Если в результате пусто – используем целиком task как одну задачу
      return raw.length ? raw : (day.task? [day.task] : []);
    }
    function buildDayGoal(day){
      // Проектные дни отмечаем явно
      if(/Проект/i.test(day.title)) return 'Применить и закрепить навыки: ' + day.title.replace(/Проект:?\s*/i,'').trim();
      return 'Освоить тему: ' + day.title;
    }

    // --- Подробные описания недель ---
    const weekDescriptions = {
      1: "Фундаментальные основы работы интернета, протокола HTTP, доменных имён и базовая публикация. Цель — понимать цепочку: пользователь → DNS → запрос → ответ браузера.",
      2: "Семантическая HTML-разметка и базовая стилизация. Формирование устойчивого навыка аккуратной структуры документа и адаптивности.",
      3: "Углубление в современный CSS: сетки, препроцессор, архитектура и поддерживаемость стилей.",
      4: "Инструменты разработчика: Git workflow, npm экосистема, стандарты форматирования и качество кода.",
      5: "Вход в JavaScript — синтаксис, базовые структуры данных, управление потоком и простые приложения.",
      6: "Практическая работа с DOM, событиями и структурой данных в браузере.",
      7: "Асинхронное программирование: таймеры, промисы, загрузка данных, обработка ошибок.",
      8: "Node.js как среда выполнения + основы модульности и сборки фронтенда.",
      9: "React: мышление в компонентах, состояние и рендеринг списков.",
      10: "Побочные эффекты, маршрутизация, формы, глобальное состояние и архитектура данных.",
      11: "Оптимизация, повторное использование логики, улучшение UX (анимации) и надежность (обработка ошибок, тесты).",
      12: "Индустриальные подходы к стилизации: UI-фреймворки, утилитарные классы и сравнение методологий.",
      13: "TypeScript — введение в типизацию, повышение надежности и рефакторинг мини-проектов.",
      14: "GraphQL: построение схем, запросы и интеграция на клиенте.",
      15: "Next.js: рендеринг на сервере, генерация статических страниц и оптимизация ресурсов.",
      16: "Аутентификация, безопасность и интеграция UI-библиотек + CMS.",
      17: "Юнит-тестирование: изоляция логики, покрытие и устойчивость к регрессиям.",
      18: "Системное E2E тестирование пользовательских сценариев и интеграция в CI.",
      19: "Производительность, доступность (a11y) и прогрессивные веб-приложения.",
      20: "Кросс-платформенность: мобильные (React Native) и десктопные (Electron) клиенты.",
      21: "Анимации и визуализация данных: повышение информативности и интерактивности интерфейсов.",
      22: "Статическая генерация (SSG), контент через Headless CMS и оптимизация цепочки поставки контента.",
      23: "CI/CD, контейнеризация и инфраструктурные практики для надежного диплоя.",
      24: "Расширенные фронтенд-паттерны: real-time, микро-фронтенды, интернационализация.",
      25: "Ревизия знаний и подготовка архитектуры итогового проекта.",
      26: "Активная разработка ключевого функционала итогового продукта.",
      27: "Тестовое покрытие, полировка производительности, SEO и UX.",
      28: "Финализация, документация, презентация и дальнейшая стратегическая траектория развития."
    };

    // --- Дополнительные ссылки по ключевым словам (рессурсы добавляются, если в дне мало ссылок) ---
    const keywordLinkGroups = [
      { match: /internet|браузер|dns/i, links: ["MDN - Как работает браузер||https://developer.mozilla.org/ru/docs/Web/Performance/How_browsers_work", "MDN - DNS||https://developer.mozilla.org/ru/docs/Glossary/DNS"] },
      { match: /http|fetch/i, links: ["MDN - HTTP заголовки||https://developer.mozilla.org/ru/docs/Web/HTTP/Headers", "HTTP Status Codes||https://http.cat/"] },
      { match: /html|семантик/i, links: ["HTML Living Standard||https://html.spec.whatwg.org/", "A11y семантика||https://web.dev/learn/accessibility/semantics"] },
      { match: /css|flex|grid|адаптив/i, links: ["MDN - Flexbox||https://developer.mozilla.org/ru/docs/Web/CSS/CSS_flexible_box_layout/Basic_concepts_of_flexbox", "MDN - Grid||https://developer.mozilla.org/ru/docs/Web/CSS/CSS_grid_layout"] },
      { match: /sass|scss/i, links: ["Sass Docs||https://sass-lang.com/documentation", "7-1 Pattern||https://sass-guidelin.es/#the-7-1-pattern"] },
      { match: /git|branch|pull/i, links: ["Pro Git||https://git-scm.com/book/ru/v2", "Git Flight Rules||https://github.com/k88hudson/git-flight-rules"] },
      { match: /node|npm|webpack|babel/i, links: ["Node.js Docs||https://nodejs.org/api/", "Webpack Concepts||https://webpack.js.org/concepts/"] },
      { match: /javascript|переменн|функц|массив|объект|json/i, links: ["JavaScript Info||https://javascript.info/", "MDN JS Reference||https://developer.mozilla.org/ru/docs/Web/JavaScript/Reference"] },
      { match: /async|promise|таймер|fetch|await/i, links: ["MDN - Promises||https://developer.mozilla.org/ru/docs/Web/JavaScript/Reference/Global_Objects/Promise", "Async/Await Guide||https://javascript.info/async-await"] },
      { match: /react|jsx|hook|context|state|router/i, links: ["React Docs||https://react.dev/", "React Patterns||https://reactpatterns.com/"] },
      { match: /typescript|ts/i, links: ["TS Handbook||https://www.typescriptlang.org/docs/handbook/intro.html", "typescript-eslint||https://typescript-eslint.io/"] },
      { match: /graphql/i, links: ["Apollo Client||https://www.apollographql.com/docs/react/", "GraphQL Best Practices||https://graphql.org/learn/best-practices/"] },
      { match: /next\.?js|ssg|ssr/i, links: ["Next.js Routing||https://nextjs.org/docs/app/building-your-application/routing", "Next.js Data Fetching||https://nextjs.org/docs/app/building-your-application/data-fetching"] },
      { match: /auth|jwt|security|безопас/i, links: ["OWASP Top 10||https://owasp.org/www-project-top-ten/", "Cheat Sheet TLS||https://cheatsheetseries.owasp.org/"] },
      { match: /test|jest|cypress|rtl|юнит/i, links: ["Testing Library||https://testing-library.com/docs/", "Cypress Docs||https://docs.cypress.io/"] },
      { match: /performance|lighthouse|оптимизац|pwa/i, links: ["web.dev Performance||https://web.dev/fast/", "Lighthouse||https://developer.chrome.com/docs/lighthouse"] },
      { match: /accessibility|a11y|доступ/i, links: ["WCAG Overview||https://www.w3.org/WAI/standards-guidelines/wcag/", "WebAIM Checklist||https://webaim.org/standards/wcag/checklist"] },
      { match: /pwa|service worker/i, links: ["MDN - Service Worker||https://developer.mozilla.org/ru/docs/Web/API/Service_Worker_API", "Manifest Guide||https://web.dev/add-manifest/"] },
      { match: /docker|ci|cd|github actions/i, links: ["GitHub Actions Docs||https://docs.github.com/actions", "Docker Docs||https://docs.docker.com/"] },
      { match: /international|i18n|локализац/i, links: ["i18next||https://www.i18next.com/", "Unicode Guide||https://home.unicode.org/"] },
      { match: /websocket|real-time|socket/i, links: ["Socket.io Docs||https://socket.io/docs/v4", "MDN - WebSockets||https://developer.mozilla.org/ru/docs/Web/API/WebSockets_API"] },
      { match: /micro|микро-фронтенд/i, links: ["Module Federation||https://webpack.js.org/concepts/module-federation/", "Micro-frontend Patterns||https://micro-frontends.org/"] },
      { match: /visual|chart|d3|диаграм/i, links: ["Chart.js||https://www.chartjs.org/docs/latest/", "D3.js Guide||https://observablehq.com/@d3/learn-d3"] },
      { match: /electron/i, links: ["Electron Docs||https://www.electronjs.org/docs", "Electron Security||https://www.electronjs.org/docs/latest/tutorial/security"] },
      { match: /react native|expo|native/i, links: ["React Native Docs||https://reactnative.dev/", "Expo Docs||https://docs.expo.dev/"] },
      { match: /seo/i, links: ["Google SEO Starter||https://developers.google.com/search/docs/fundamentals/seo-starter-guide", "Open Graph||https://ogp.me/"] },
      { match: /readme|презентац|linkedin|резюме/i, links: ["Awesome README||https://github.com/matiassingers/awesome-readme", "LinkedIn Profile Tips||https://www.linkedin.com/help/linkedin/answer/a507663"] }
    ];

    // удалено дублирующее объявление state, теперь оно только в начале скрипта
    let currentFilter = 'all';

  // --- Состояние развёрнутых "Материалы" по дням ---
  let extraOpen = {};
  try { extraOpen = JSON.parse(localStorage.getItem('frontendExtraOpen')||'{}')||{}; } catch(e){ extraOpen = {}; }
  function saveExtraOpen(){ localStorage.setItem('frontendExtraOpen', JSON.stringify(extraOpen)); }
  function toggleExtra(day){
    extraOpen[day] = !extraOpen[day];
    saveExtraOpen();
    const wrap = document.getElementById('extra'+day);
    const btn = document.getElementById('mtgl'+day);
    if(wrap && btn){
      if(extraOpen[day]){ wrap.classList.remove('collapsed'); void wrap.offsetWidth; wrap.classList.add('fade-in'); btn.classList.add('open'); }
      else { wrap.classList.add('collapsed'); wrap.classList.remove('fade-in'); btn.classList.remove('open'); }
      updateMaterialBadge(day);
    }
  }

    // --- Пользовательские заметки и вложения ---
  let notesState = {};
  let attachmentsState = {}; // { day: { links: [{title,url}], files:[{name,data,size}] } }
  let subtasksState = {}; // { day: [{text, done}] }
  // Состояние внутренних секций (subtasks/notes/attachments)
  let sectionOpen = {}; // { day: { subtasks:true, notes:true, attachments:true } }
    try { notesState = JSON.parse(localStorage.getItem('frontendNotes')||'{}')||{}; } catch(e){ notesState = {}; }
  try { attachmentsState = JSON.parse(localStorage.getItem('frontendAttachments')||'{}')||{}; } catch(e){ attachmentsState = {}; }
  try { subtasksState = JSON.parse(localStorage.getItem('frontendSubtasks')||'{}')||{}; } catch(e){ subtasksState = {}; }
  try { sectionOpen = JSON.parse(localStorage.getItem('frontendSectionOpen')||'{}')||{}; } catch(e){ sectionOpen = {}; }

  function saveSectionOpen(){ localStorage.setItem('frontendSectionOpen', JSON.stringify(sectionOpen)); }
  function ensureSectionDefaults(day){
    if(!sectionOpen[day]){ sectionOpen[day] = { subtasks:true, notes:true, attachments:true }; }
  }
  function toggleSection(day, sec){
    ensureSectionDefaults(day);
    sectionOpen[day][sec] = !sectionOpen[day][sec];
    saveSectionOpen();
    applySectionState(day, sec);
  }
  function applySectionState(day, sec){
    const btn = document.getElementById(sec+'Toggle'+day);
    const body = document.getElementById(sec+'Body'+day);
    if(!btn || !body) return;
    const open = sectionOpen[day]?.[sec];
    if(open){ btn.classList.add('open'); body.classList.remove('collapsed'); }
    else { btn.classList.remove('open'); body.classList.add('collapsed'); }
  }

    function saveNotes(){ localStorage.setItem('frontendNotes', JSON.stringify(notesState)); scheduleCloudUpload(); }
  function saveAttachments(){ localStorage.setItem('frontendAttachments', JSON.stringify(attachmentsState)); scheduleCloudUpload(); }
  function saveSubtasks(){ localStorage.setItem('frontendSubtasks', JSON.stringify(subtasksState)); scheduleCloudUpload(); }
    // Миграция: если значение было строкой — оборачиваем в массив заметок
    function migrateNotes(){
      Object.keys(notesState).forEach(k => {
        if(typeof notesState[k] === 'string'){
          const trimmed = notesState[k].trim();
          notesState[k] = trimmed ? [{ text: trimmed, ts: Date.now() }] : [];
        }
      });
      saveNotes();
    }
    migrateNotes();
    function addNote(day, text){
      const val = (text||'').trim(); if(!val) return;
      if(!Array.isArray(notesState[day])) notesState[day] = [];
      notesState[day].push({ text: escapeHTML(val), ts: Date.now() });
      saveNotes();
      renderNotes(day);
      updateMaterialBadge(day);
    }
    function deleteNote(day, idx){ if(!Array.isArray(notesState[day])) return; notesState[day].splice(idx,1); saveNotes(); renderNotes(day); updateMaterialBadge(day); }
    function renderNotes(day){
      const listEl = document.getElementById('notesList'+day); if(!listEl) return;
      const arr = Array.isArray(notesState[day]) ? notesState[day] : [];
      if(!arr.length){ listEl.innerHTML = '<li style="opacity:.5;font-size:11px;">(нет заметок)</li>'; return; }
      listEl.innerHTML = arr.map((n,i)=>`<li><span class="inline-badge">NOTE</span><span class="note-text">${n.text}</span><button class="x-btn" title="Удалить" onclick="deleteNote(${day},${i})">✕</button></li>`).join('');
    }
    function addLink(day){
      const t = document.getElementById('linkTitle'+day);
      const u = document.getElementById('linkUrl'+day);
      const title = (t.value||'Ссылка').trim();
      const url = (u.value||'').trim();
      if(!/^https?:\/\//i.test(url)){ alert('Укажите корректный URL (http/https).'); return; }
      if(!attachmentsState[day]) attachmentsState[day] = { links: [], files: [] };
      attachmentsState[day].links.push({ title: escapeHTML(title), url: url });
      saveAttachments();
      t.value=''; u.value='';
      // перерисуем только список
      renderUserLinks(day);
      updateMaterialBadge(day);
    }
    function deleteLink(day, idx){ if(!attachmentsState[day]) return; attachmentsState[day].links.splice(idx,1); saveAttachments(); renderUserLinks(day); updateMaterialBadge(day); }
    function handleFileUpload(day, input){
      const files = Array.from(input.files||[]);
      if(!files.length) return;
      if(!attachmentsState[day]) attachmentsState[day] = { links: [], files: [] };
      const MAX_SIZE = 200 * 1024; // 200KB per file
      let warn = [];
      let readCount = 0;
      files.forEach(file => {
        if(file.size > MAX_SIZE){ warn.push(file.name); return; }
        const reader = new FileReader();
        reader.onload = e => {
          attachmentsState[day].files.push({ name: escapeHTML(file.name), data: e.target.result, size: file.size });
          readCount++;
          if(readCount === files.filter(f=>f.size<=MAX_SIZE).length){ saveAttachments(); renderUserFiles(day); updateMaterialBadge(day); }
        };
        reader.readAsDataURL(file);
      });
      if(warn.length) alert('Некоторые файлы превышают лимит 200KB и не были добавлены: '+warn.join(', '));
      input.value='';
    }
    function deleteFile(day, idx){ if(!attachmentsState[day]) return; attachmentsState[day].files.splice(idx,1); saveAttachments(); renderUserFiles(day); updateMaterialBadge(day); }
    function bytesToKB(b){ return (b/1024).toFixed(1)+' KB'; }
    function escapeHTML(str){ return str.replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#39;'}[c]||c)); }
    function renderUserLinks(day){
      const ul = document.querySelector(`#userLinks${day}`); if(!ul) return;
      const list = (attachmentsState[day]?.links)||[];
  ul.innerHTML = list.map((l,i)=>`<li><span class="inline-badge">LINK</span><a href="${l.url}" target="_blank">${l.title}</a><button class="x-btn" onclick="deleteLink(${day},${i})" title="Удалить">✕</button></li>`).join('');
    }
    function renderUserFiles(day){
      const ul = document.querySelector(`#userFiles${day}`); if(!ul) return;
      const list = (attachmentsState[day]?.files)||[];
  ul.innerHTML = list.map((f,i)=>`<li><span class="inline-badge">FILE</span><a download="${f.name}" href="${f.data}">${f.name}</a><span class="file-size">${bytesToKB(f.size)}</span><button class="x-btn" onclick="deleteFile(${day},${i})" title="Удалить">✕</button></li>`).join('');
    }
    // --- Подзадачи дней ---
    function generateTemplateSubtasks(dayObj){
      const title = (dayObj.title||'').toLowerCase();
      const task = (dayObj.task||'').toLowerCase();
      const rawPieces = (dayObj.task||'')
        .split(/[.;]+/)
        .map(s=>s.trim())
        .filter(s=>s.length>4);
      const subtasks = [];
      const push = t => { if(t && !subtasks.includes(t)) subtasks.push(t); };

      // Общие базовые шаги
      push('Прочитать теорию/документацию по теме');
      push('Сделать краткий конспект (5–7 пунктов)');

      // Категории
      if(/internet|dns|браузер|http/.test(task+title)){
        push('Нарисовать схему: клиент → DNS → сервер → ответ');
        push('Открыть DevTools → Network и проанализировать 3 запроса');
      }
      if(/git|ветк|branch|pull|merge/.test(task+title)){
        push('Создать тестовую ветку и выполнить merge через PR');
        push('Разрешить (симулировать) конфликт слияния');
      }
      if(/форм|form/.test(task+title)){
        push('Сверстать форму с валидацией HTML-атрибутами');
        push('Проверить фокус и доступность (Tab-навигация)');
      }
      if(/flex|grid/.test(task+title)){
        push('Перестроить макет под мобильный (<600px)');
        push('Проверить выравнивание элементов в разных браузерах');
      }
      if(/sass|scss/.test(task+title)){
        push('Вынести цвета и размеры в переменные');
        push('Разбить стили на partials и импортировать их');
      }
      if(/javascript|переменн|функц|массив|объект|json/.test(task+title)){
        push('Написать минимум 3 мини-примера в консоли');
        push('Объяснить вслух что делает каждый пример');
      }
      if(/promise|async|await|fetch/.test(task+title)){
        push('Сделать запрос fetch и обработать ошибки');
        push('Переписать пример на async/await');
      }
      if(/react|jsx|hook|context|state/.test(task+title)){
        push('Создать маленький компонент (50-70 строк) для практики');
        push('Добавить минимум 1 проверку состояния/условный рендер');
      }
      if(/typescript|ts/.test(task+title)){
        push('Заменить any на конкретный тип');
        push('Добавить интерфейс или type для структуры данных');
      }
      if(/test|jest|cypress|rtl/.test(task+title)){
        push('Написать 1 позитивный и 1 негативный тест');
        push('Посмотреть падающий тест и починить причину');
      }
      if(/performance|оптимизац|lighthouse|pwa/.test(task+title)){
        push('Сделать замер Lighthouse до изменений');
        push('Применить оптимизацию и сравнить метрики');
      }
      if(/git hub actions|ci|cd|docker/.test(task+title)){
        push('Настроить простой workflow build+test');
        push('Добавить бейдж статуса в README');
      }
      if(/проект|spa|блог|магазин|реал-?time|чат|final|итог/i.test(task+title)){
        push('Сформулировать 3 ближайших шага по проекту');
        push('Сделать коммит с осмысленным сообщением');
      }

      // Из исходного task вытаскиваем глаголы и формируем задания «Сделать ...»
      rawPieces.forEach(p=>{
        const low = p.toLowerCase();
        if(/проанализир|разбор|посмотреть/.test(low)) push('Проанализировать пример из документации');
        if(/созда|сдела|реализ|оптимиз|добав|перенес|перепис/.test(low)) push('Реализовать мини-версию на практике');
      });

      // Финальные обязательные шаги
      push('Подвести итоги: 2-3 вывода в заметках');

      return subtasks.slice(0,8);
    }
    function ensureSubtasks(dayObj){
      const generated = generateTemplateSubtasks(dayObj);
      if(!subtasksState[dayObj.day]){
        subtasksState[dayObj.day] = generated.map(t=>({text:t, done:false, system:true}));
        if(generated.length) saveSubtasks();
        return;
      }
      let changed = false;
      // Миграция: добавить system где отсутствует
      subtasksState[dayObj.day] = subtasksState[dayObj.day].map(item => {
        if(item.system === undefined){
          const isSystem = generated.some(g => g === item.text);
            if(isSystem){ item.system = true; changed = true; }
            else { item.system = false; changed = true; }
        }
        return item;
      });
      // Добавить отсутствующие системные
      generated.forEach(t => {
        if(!subtasksState[dayObj.day].some(it => it.text === t)){
          subtasksState[dayObj.day].push({ text: t, done:false, system:true });
          changed = true;
        }
      });
      if(changed) saveSubtasks();
    }
    function renderSubtasks(day){
      const wrap = document.getElementById('subtasks'+day); if(!wrap) return;
      const list = subtasksState[day]||[];
  const ul = wrap.querySelector('.subtask-list'); if(!ul) return;
  ul.innerHTML = list.map((s,i)=>`<li class="subtask-item ${s.done?'done':''}"><input type="checkbox" ${s.done?'checked':''} onchange="toggleSubtask(${day},${i})"><div class="subtask-box"><span>${s.text}</span>${s.system?'<span class="sys-badge" title="Системная подзадача">SYS</span>':`<button aria-label="Удалить" title="Удалить подзадачу" onclick="deleteSubtask(${day},${i})">✕</button>`}</div></li>`).join('');
  updateSubtaskProgress(day);
    }
    function toggleSubtask(day, idx){ const arr = subtasksState[day]; if(!arr) return; arr[idx].done = !arr[idx].done; saveSubtasks(); renderSubtasks(day); }
    function addSubtask(day){ const input = document.getElementById('newSubtask'+day); if(!input) return; const val = input.value.trim(); if(!val) return; if(!subtasksState[day]) subtasksState[day]=[]; subtasksState[day].push({text:val, done:false}); saveSubtasks(); input.value=''; renderSubtasks(day); }
  function deleteSubtask(day, idx){ if(!subtasksState[day]) return; if(subtasksState[day][idx]?.system) return; subtasksState[day].splice(idx,1); saveSubtasks(); renderSubtasks(day); }
  function updateSubtaskProgress(day){ const btn = document.getElementById('subtasksToggle'+day); const prog = document.getElementById('subtasksProg'+day); if(!btn || !prog) return; const list = subtasksState[day]||[]; const total = list.length; const done = list.filter(s=>s.done).length; prog.textContent = `${done}/${total}`; }
    // Обновление бейджей материалов на кнопке
    function updateMaterialBadge(day){
      const btn = document.getElementById('mtgl'+day); if(!btn) return;
      const linksCount = (attachmentsState[day]?.links?.length)||0;
      const filesCount = (attachmentsState[day]?.files?.length)||0;
      const noteActive = Array.isArray(notesState[day]) ? notesState[day].length>0 : (typeof notesState[day]==='string' && notesState[day].trim().length>0);
      const isOpen = !!extraOpen[day];
      btn.innerHTML = `<span class="arrow">▶</span>${isOpen? ' Скрыть материалы':' Материалы'}<span class="mat-badges">`
        + (linksCount? `<span class=\"mat-badge link\" title=\"Пользовательских ссылок\">🔗 ${linksCount}</span>`:'')
        + (filesCount? `<span class=\"mat-badge file\" title=\"Загруженных файлов\">📁 ${filesCount}</span>`:'')
        + (noteActive? `<span class=\"mat-badge note\" title=\"Заметок\">📝 ${Array.isArray(notesState[day])? notesState[day].length:1}</span>`:'')
        + `</span>`;
    }

    // Инициализация темы
    function initTheme() {
      const savedTheme = localStorage.getItem('theme');
      if (savedTheme) {
        document.body.setAttribute('data-theme', savedTheme);
      } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.setAttribute('data-theme', 'dark');
      } else {
        document.body.setAttribute('data-theme', 'light');
      }
    }

    function toggleTheme() {
      const currentTheme = document.body.getAttribute('data-theme') || 'dark';
      const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
      document.body.setAttribute('data-theme', newTheme);
      localStorage.setItem('theme', newTheme);
    }

    // Слушаем изменения системной темы
    if (window.matchMedia) {
      window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
        if (!localStorage.getItem('theme')) {
          document.body.setAttribute('data-theme', e.matches ? 'dark' : 'light');
        }
      });
    }

    function save(){ localStorage.setItem('frontendPlan', JSON.stringify(state)); scheduleCloudUpload(); }

    function toggle(day) {
      state[day] = !state[day];
      save();
      updateStats();
      render();
    }

    function updateStats() {
      let done = Object.keys(state).filter(k => state[k]).length;
      let left = 196 - done;
      let pct = Math.round((done / 196) * 100);

      document.getElementById('done').textContent = done;
      document.getElementById('left').textContent = left;
      document.getElementById('pct').textContent = pct + '%';

      const bar = document.getElementById('bar');
      bar.style.width = pct + '%';
      bar.textContent = pct + '%';
    }

    // --- Состояние открытых списков ---
    let openState = { months: [], weeks: [] };
    if (localStorage.getItem('frontendOpenState')) {
      try {
        openState = JSON.parse(localStorage.getItem('frontendOpenState')) || { months: [], weeks: [] };
      } catch (e) {
        openState = { months: [], weeks: [] };
      }
    }

    function saveOpenState() {
      localStorage.setItem('frontendOpenState', JSON.stringify(openState));
    }

    function buildExtraLinks(day) {
      const base = [...(day.links || [])];
      const text = (day.title + ' ' + day.task).toLowerCase();
      keywordLinkGroups.forEach(group => {
        if (group.match.test(text)) {
          group.links.forEach(l => { if (!base.includes(l)) base.push(l); });
        }
      });
      return base;
    }

    // --- Категоризация дней для сводки ---
    function categorizeDay(day){
      const txt = (day.title + ' ' + day.task).toLowerCase();
      if(/internet|dns|http|браузер/.test(txt)) return 'Сеть';
      if(/html|семантик|форма|валид/i.test(txt)) return 'HTML';
      if(/css|flex|grid|sass|scss|tailwind|bootstrap/.test(txt)) return 'CSS';
      if(/javascript|переменн|функц|массив|объект|json|async|promise|fetch/.test(txt)) return 'JS';
      if(/react|jsx|hook|context|router|next\.js|nextjs/.test(txt)) return 'React/Next';
      if(/typescript|ts/.test(txt)) return 'TypeScript';
      if(/graphql/.test(txt)) return 'GraphQL';
      if(/test|jest|cypress|rtl/.test(txt)) return 'Тесты';
      if(/docker|ci|github actions|workflow/.test(txt)) return 'CI/CD';
      if(/performance|lighthouse|pwa|a11y|accessibility/.test(txt)) return 'Perf/A11y';
      if(/проект|spa|блог|магазин|final|итог|project/.test(txt)) return 'Проект';
      return 'Прочее';
    }

    function collectCategoryStats(){
      const stats = {};
      plan.forEach(m => m.weeks.forEach(w => w.days.forEach(d => {
        const cat = categorizeDay(d);
        if(!stats[cat]) stats[cat] = { total:0, done:0 };
        stats[cat].total++;
        if(state[d.day]) stats[cat].done++;
      })));
      return stats;
    }

    function renderCategorySummary(){
      const holder = document.getElementById('categoriesSummary'); if(!holder) return;
      const stats = collectCategoryStats();
      const entries = Object.entries(stats).sort((a,b)=>a[0].localeCompare(b[0],'ru'));
      holder.innerHTML = entries.map(([cat,data])=>{
        const pct = data.total? Math.round(data.done/data.total*100):0;
        return `<div class="cat-card${pct===100?' highlight':''}"><h4>${cat}</h4><div class="cat-metric">${data.done}/${data.total}</div><div class="cat-bar"><span style="width:${pct}%"></span></div><div class="cat-pct">${pct}%</div></div>`;
      }).join('');
    }

    // --- Weekly progress bars ---
    function injectWeekProgress(){
      document.querySelectorAll('.week').forEach(weekEl => {
        const header = weekEl.querySelector('.week-header');
        if(!header) return;
        const daysBlock = weekEl.querySelector('.days');
        const spans = header.querySelectorAll('span');
        const progressText = spans[spans.length-1]?.textContent||''; // x/y
        const match = progressText.match(/(\d+)\/(\d+)/);
        if(!match) return;
        const done = +match[1]; const total = +match[2];
        const pct = total? Math.round(done/total*100):0;
        let bar = weekEl.querySelector('.week-progress');
        if(!bar){
          bar = document.createElement('div');
          bar.className='week-progress';
          bar.dataset.label = pct + '%';
          const fill = document.createElement('span');
          bar.appendChild(fill);
          daysBlock.parentNode.insertBefore(bar, daysBlock);
          requestAnimationFrame(()=>{ fill.style.width = pct+'%'; });
        } else {
          bar.dataset.label = pct + '%';
          const fill = bar.querySelector('span');
          fill.style.width = pct+'%';
        }
      });
    }

    // --- Экспорт / импорт ---
    function exportData(){
      const payload = {
        version: 1,
        exportedAt: new Date().toISOString(),
        state, notesState, attachmentsState, subtasksState, extraOpen, openState, sectionOpen, theme: document.body.getAttribute('data-theme')
      };
      const blob = new Blob([JSON.stringify(payload,null,2)], {type:'application/json'});
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'frontend-tracker-backup.json';
      document.body.appendChild(a); a.click(); a.remove();
    }
    function handleImport(input){
      const file = input.files[0]; if(!file) return; const reader = new FileReader();
      reader.onload = e => {
        try {
          const data = JSON.parse(e.target.result);
          if(!data || typeof data !== 'object') throw new Error('Некорректный формат');
          if(data.state) state = data.state;
          if(data.notesState) notesState = data.notesState;
          if(data.attachmentsState) attachmentsState = data.attachmentsState;
            if(data.subtasksState) subtasksState = data.subtasksState;
          if(data.extraOpen) extraOpen = data.extraOpen;
          if(data.openState) openState = data.openState;
          if(data.sectionOpen) sectionOpen = data.sectionOpen;
          if(data.theme) { document.body.setAttribute('data-theme', data.theme); localStorage.setItem('theme', data.theme); }
          save(); saveNotes(); saveAttachments(); saveSubtasks(); saveExtraOpen(); saveOpenState(); saveSectionOpen();
          updateStats(); render();
          alert('Импорт завершён успешно');
        } catch(err){ alert('Ошибка импорта: '+err.message); }
        input.value='';
      };
      reader.readAsText(file);
    }

    // --- Оценка использования localStorage ---
    function estimateStorageUsage(){
      let total = 0; for(let i=0;i<localStorage.length;i++){ const k = localStorage.key(i); const v = localStorage.getItem(k); total += (k.length + v.length); }
      // localStorage обычно ~5MB per origin. Возьмём 5*1024*1024 ≈ 5242880 bytes.
      const limit = 5 * 1024 * 1024;
      const pct = Math.min(100, Math.round(total / limit * 100));
      const bar = document.getElementById('storageUsageBar'); const pctEl = document.getElementById('storageUsagePct');
      if(bar){ bar.style.width = pct + '%'; }
      if(pctEl){ pctEl.textContent = pct + '%'; pctEl.style.color = pct>80? '#f87171' : pct>60? '#fbbf24' : 'var(--text-secondary)'; }
    }

    function render() {
      const html = plan.map(month => {
        const monthProgress = `${month.weeks.reduce((s, w) => s + w.days.filter(d => state[d.day]).length, 0)}/${month.weeks.reduce((s, w) => s + w.days.length, 0)}`;
        const monthTasks = buildMonthTasks(month);
        return `
        <div class="month">
          <div class="month-header" onclick="toggleMonth(${month.month})">
            <span class="month-title">${month.title}</span>
            <span>${monthProgress}</span>
          </div>
          <div id="month${month.month}" class="${openState.months.includes(month.month) ? '' : 'collapsed'}">
            <div class="month-objectives">
              <div class="mo-goal"><strong>Цель месяца:</strong> ${monthMeta[month.month]?.goal||''}</div>
              <ul class="mo-tasks">${monthTasks.map(t=>`<li>${t}</li>`).join('')}</ul>
            </div>
            ${month.weeks.map(week => {
          const weekProgress = `${week.days.filter(d => state[d.day]).length}/${week.days.length}`;
          const weekTasks = buildWeekTasks(week);
          return `
              <div class="week">
                <div class="week-header" onclick="toggleWeek(${week.week})">
                  <span>${week.title}</span>
                  <span>${weekProgress}</span>
                </div>
                <div class="week-objectives">
                  <div class="wg-goal"><strong>Цель недели:</strong> ${weekDescriptions[week.week]||''}</div>
                  <ul class="wg-tasks">${weekTasks.map(t=>`<li>${t}</li>`).join('')}</ul>
                </div>
                <div id="week${week.week}" class="days ${openState.weeks.includes(week.week) ? '' : 'collapsed'}">
                  ${week.days.map(day => {
            const effectiveLinks = buildExtraLinks(day);
            const dayGoal = buildDayGoal(day);
            const dayTasks = buildDayTasks(day);
            return `
                    <div class="day ${state[day.day] ? 'done' : ''}" data-day="${day.day}">
                      <div class="day-header">
                        <input type="checkbox" ${state[day.day] ? 'checked' : ''} onchange="toggle(${day.day})">
                        <div class="day-info">
                          <div class="day-title">
                            День ${day.day}: ${day.title}
                            <span class="day-time">${day.time}</span>
                          </div>
                          <div class="day-goal-line"><strong>Цель:</strong> ${dayGoal}</div>
                          ${dayTasks.length ? `<ul class="day-tasks-list">${dayTasks.map(t=>`<li>${t}</li>`).join('')}</ul>`:''}
                          <div class="day-task">${day.task}</div>
                          ${effectiveLinks.length ? `
                            <div class="day-resources">
                              ${effectiveLinks.map(l => {
              const [title, url] = l.split('||');
              return `<a href=\"${url}\" target=\"_blank\">📚 ${title}</a>`;
            }).join('')}
                            </div>
                          ` : ''}
                          <div class="day-extra" id="extra${day.day}">
                            <div class="day-subtasks" id="subtasks${day.day}">
                              <button type="button" id="subtasksToggle${day.day}" class="section-toggle" onclick="toggleSection(${day.day},'subtasks')">Подзадачи <span class="st-progress" id="subtasksProg${day.day}"></span></button>
                              <div class="section-body" id="subtasksBody${day.day}">
                                <ul class="subtask-list"></ul>
                                <div class="add-subtask">
                                  <input id="newSubtask${day.day}" placeholder="Новая подзадача...">
                                  <button type="button" onclick="addSubtask(${day.day})">Добавить</button>
                                </div>
                              </div>
                            </div>
                            <div class="note-block" id="note${day.day}">
                              <button type="button" id="notesToggle${day.day}" class="section-toggle" onclick="toggleSection(${day.day},'notes')">Заметки</button>
                              <div class="section-body" id="notesBody${day.day}">
                                <input type="text" id="noteInput${day.day}" placeholder="Добавить заметку и Enter" style="width:100%;padding:8px 10px;border:1px solid var(--border-color);border-radius:8px;background:var(--bg-secondary);color:var(--text-primary);font-size:12px;" onkeydown="if(event.key==='Enter'){addNote(${day.day}, this.value); this.value=''; event.preventDefault();}">
                                <ul id="notesList${day.day}" style="list-style:none;margin:8px 0 0;padding:0;display:flex;flex-direction:column;gap:6px;"></ul>
                              </div>
                            </div>
                            <div class="attachments-block" id="attachments${day.day}">
                              <button type="button" id="attachmentsToggle${day.day}" class="section-toggle" onclick="toggleSection(${day.day},'attachments')">Файлы и ссылки</button>
                              <div class="section-body" id="attachmentsBody${day.day}">
                                <div class="attach-links">
                                  <input type="text" id="linkTitle${day.day}" placeholder="Название">
                                  <input type="url" id="linkUrl${day.day}" placeholder="https://ссылка...">
                                  <button type="button" onclick="addLink(${day.day})">+</button>
                                </div>
                                <ul class="user-links" id="userLinks${day.day}"></ul>
                                <div class="attach-files file-wrapper">
                                  <label class="file-btn" for="fileInput${day.day}">📁 Выбрать файлы</label>
                                  <input id="fileInput${day.day}" type="file" multiple onchange="handleFileUpload(${day.day}, this)" title="До 200KB на файл">
                                  <span class="attach-hint">Лимит 200KB/файл (хранится в localStorage).</span>
                                </div>
                                <ul class="user-files" id="userFiles${day.day}"></ul>
                              </div>
                            </div>
                          </div>
                          <div id="materialsToggle${day.day}">
                            <button id="mtgl${day.day}" class="materials-toggle ${extraOpen[day.day] ? 'open':''}" type="button" onclick="toggleExtra(${day.day})"><span class="arrow">▶</span>${extraOpen[day.day] ? ' Скрыть материалы' : ' Материалы'}<span class="mat-badges"></span></button>
                          </div>
                        </div>
                      </div>
                    </div>`;
          }).join('')}
                </div>
              </div>`;
        }).join('')}
          </div>
        </div>`;
      }).join('');

      document.getElementById('content').innerHTML = html;
      applyFilter();
      // После рендера восстановим пользовательские ссылки/файлы и состояния материалов
  Object.keys(attachmentsState).forEach(day => { renderUserLinks(day); renderUserFiles(day); });
  // Инициализация и рендер подзадач (генерируются один раз)
  plan.forEach(m => m.weeks.forEach(w => w.days.forEach(d => { ensureSubtasks(d); renderSubtasks(d.day); })));
  // Обновим бейджи материалов после восстановления списков
  plan.forEach(m => m.weeks.forEach(w => w.days.forEach(d => updateMaterialBadge(d.day))));
      // Скрываем/показываем материалы по сохранённому состоянию
      plan.forEach(m => m.weeks.forEach(w => w.days.forEach(d => {
        const container = document.getElementById('extra'+d.day);
        if(container){ if(!extraOpen[d.day]) container.classList.add('collapsed'); }
        // Применим состояние внутренних секций
        ensureSectionDefaults(d.day);
        ['subtasks','notes','attachments'].forEach(sec => applySectionState(d.day, sec));
        renderNotes(d.day);
      })));
      // Кольца прогресса месяцев (встраиваем после генерации DOM)
      document.querySelectorAll('.month').forEach(monthEl => {
        const header = monthEl.querySelector('.month-header');
        if(!header) return;
        const textSpan = header.querySelector('span:last-child');
        if(!textSpan) return;
        const match = textSpan.textContent.match(/(\d+)\/(\d+)/);
        if(!match) return;
        const done = +match[1]; const total = +match[2];
        const pct = total ? Math.round(done/total*100) : 0;
        if(!header.querySelector('.month-ring')){
          const ring = document.createElement('div');
          ring.className='month-ring';
          ring.style.setProperty('--p', pct);
          ring.innerHTML = '<span>'+pct+'%</span>';
          header.insertBefore(ring, header.firstChild);
        } else {
          const ring = header.querySelector('.month-ring');
          ring.style.setProperty('--p', pct);
          ring.innerHTML = '<span>'+pct+'%</span>';
        }
      });
      injectWeekProgress();
      renderCategorySummary();
      estimateStorageUsage();
    }

    function toggleMonth(m) {
      const idx = openState.months.indexOf(m);
      if (idx === -1) {
        openState.months.push(m);
      } else {
        openState.months.splice(idx, 1);
      }
      // При закрытии месяца закрываем все его недели
      if (openState.months.indexOf(m) === -1) {
        const monthObj = plan.find(mon => mon.month === m);
        if (monthObj) {
          monthObj.weeks.forEach(w => {
            const wIdx = openState.weeks.indexOf(w.week);
            if (wIdx !== -1) openState.weeks.splice(wIdx, 1);
          });
        }
      }
      saveOpenState();
      render();
    }

    function toggleWeek(w) {
      const idx = openState.weeks.indexOf(w);
      if (idx === -1) {
        openState.weeks.push(w);
      } else {
        openState.weeks.splice(idx, 1);
      }
      saveOpenState();
      render();
    }

    function filter(type) {
      currentFilter = type;
      document.querySelectorAll('.btn-filter').forEach(b => b.classList.remove('active'));
      event.target.classList.add('active');
      applyFilter();
    }

    function resetFilter(){ currentFilter='all'; document.querySelectorAll('.btn-filter').forEach(b=>b.classList.remove('active')); document.querySelector('.btn-filter[onclick="filter('+'\'all\''+')"]')?.classList.add('active'); applyFilter(); }

    function scrollToNextIncomplete(){
      const visibleDays = Array.from(document.querySelectorAll('.day')).filter(d=>d.style.display !== 'none');
      const next = visibleDays.find(d => !state[d.dataset.day]);
      if(next){ next.scrollIntoView({behavior:'smooth', block:'center'}); next.classList.add('highlight-temp'); setTimeout(()=>next.classList.remove('highlight-temp'),1500); }
      else { alert('Все видимые дни завершены 🎉'); }
    }
    function expandAll(){ openState.months = plan.map(m=>m.month); openState.weeks = plan.flatMap(m=>m.weeks.map(w=>w.week)); saveOpenState(); render(); }
    function collapseAll(){ openState.months = []; openState.weeks = []; saveOpenState(); render(); }

    function applyFilter() {
      document.querySelectorAll('.day').forEach(day => {
        const dayNum = day.dataset.day;
        const done = state[dayNum];
        let show = currentFilter === 'all' ||
          (currentFilter === 'done' && done) ||
          (currentFilter === 'todo' && !done);
        day.style.display = show ? 'block' : 'none';
      });
    }

    function reset() {
      if (confirm('Вы уверены, что хотите сбросить весь прогресс обучения?')) {
        state = {};
        save();
        updateStats();
        render();
      }
    }

    document.getElementById('search').oninput = (e) => {
      const term = e.target.value.toLowerCase();
      document.querySelectorAll('.day').forEach(day => {
        const match = day.textContent.toLowerCase().includes(term);
        day.style.display = match ? 'block' : 'none';
      });
    };

    updateStats();
    render();
    if(typeof updateCloudUI === 'function') updateCloudUI();
  </script>
</body>

</html>
